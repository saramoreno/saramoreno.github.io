{"version":3,"file":"256b551e-944e9931f0ff3bfa2408.js","mappings":"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","sources":["webpack://bonsai-web/./node_modules/@babylonjs/core/Engines/thinEngine.js"],"sourcesContent":["import _asyncToGenerator from \"/Users/sara/Proyectos/bonsai/bonsai-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _createClass from \"/Users/sara/Proyectos/bonsai/bonsai-web/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/sara/Proyectos/bonsai/bonsai-web/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _regeneratorRuntime from \"/Users/sara/Proyectos/bonsai/bonsai-web/node_modules/@babel/runtime/regenerator/index.js\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { EngineStore } from \"./engineStore.js\";\nimport { Effect } from \"../Materials/effect.js\";\nimport { _WarnImport } from \"../Misc/devTools.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { DepthCullingState } from \"../States/depthCullingState.js\";\nimport { StencilState } from \"../States/stencilState.js\";\nimport { AlphaState } from \"../States/alphaCullingState.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { IsDocumentAvailable, IsWindowObjectExist } from \"../Misc/domManagement.js\";\nimport { WebGLShaderProcessor } from \"./WebGL/webGLShaderProcessors.js\";\nimport { WebGL2ShaderProcessor } from \"./WebGL/webGL2ShaderProcessors.js\";\nimport { WebGLDataBuffer } from \"../Meshes/WebGL/webGLDataBuffer.js\";\nimport { WebGLPipelineContext } from \"./WebGL/webGLPipelineContext.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\nimport { WebGLHardwareTexture } from \"./WebGL/webGLHardwareTexture.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { StencilStateComposer } from \"../States/stencilStateComposer.js\";\nimport { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\n/**\n * Keeps track of all the buffer info used in engine.\n */\n\nvar BufferPointer = /*#__PURE__*/_createClass(function BufferPointer() {\n  _classCallCheck(this, BufferPointer);\n});\n/**\n * The base engine class (root of all engines)\n */\n\n\nexport var ThinEngine = /*#__PURE__*/function () {\n  /**\n   * Creates a new engine\n   * @param canvasOrContext defines the canvas or WebGL context to use for rendering. If you provide a WebGL context, Babylon.js will not hook events on the canvas (like pointers, keyboards, etc...) so no event observables will be available. This is mostly used when Babylon.js is used as a plugin on a system which already used the WebGL context\n   * @param antialias defines enable antialiasing (default: false)\n   * @param options defines further options to be sent to the getContext() function\n   * @param adaptToDeviceRatio defines whether to adapt to the device's viewport characteristics (default: false)\n   */\n  function ThinEngine(canvasOrContext, antialias, options, adaptToDeviceRatio) {\n    var _adaptToDeviceRatio,\n        _this = this;\n\n    _classCallCheck(this, ThinEngine);\n\n    /** @internal */\n    this._name = \"WebGL\";\n    /**\n     * Gets or sets a boolean that indicates if textures must be forced to power of 2 size even if not required\n     */\n\n    this.forcePOTTextures = false;\n    /**\n     * Gets a boolean indicating if the engine is currently rendering in fullscreen mode\n     */\n\n    this.isFullscreen = false;\n    /**\n     * Gets or sets a boolean indicating if back faces must be culled. If false, front faces are culled instead (true by default)\n     * If non null, this takes precedence over the value from the material\n     */\n\n    this.cullBackFaces = null;\n    /**\n     * Gets or sets a boolean indicating if the engine must keep rendering even if the window is not in foreground\n     */\n\n    this.renderEvenInBackground = true;\n    /**\n     * Gets or sets a boolean indicating that cache can be kept between frames\n     */\n\n    this.preventCacheWipeBetweenFrames = false;\n    /** Gets or sets a boolean indicating if the engine should validate programs after compilation */\n\n    this.validateShaderPrograms = false;\n    this._useReverseDepthBuffer = false;\n    /**\n     * Indicates if the z range in NDC space is 0..1 (value: true) or -1..1 (value: false)\n     */\n\n    this.isNDCHalfZRange = false;\n    /**\n     * Indicates that the origin of the texture/framebuffer space is the bottom left corner. If false, the origin is top left\n     */\n\n    this.hasOriginBottomLeft = true;\n    /**\n     * Gets or sets a boolean indicating that uniform buffers must be disabled even if they are supported\n     */\n\n    this.disableUniformBuffers = false;\n    /**\n     * An event triggered when the engine is disposed.\n     */\n\n    this.onDisposeObservable = new Observable();\n    this._frameId = 0;\n    /** @internal */\n\n    this._uniformBuffers = new Array();\n    /** @internal */\n\n    this._storageBuffers = new Array();\n    /** @internal */\n\n    this._webGLVersion = 1.0;\n    this._windowIsBackground = false;\n    this._highPrecisionShadersAllowed = true;\n    /** @internal */\n\n    this._badOS = false;\n    /** @internal */\n\n    this._badDesktopOS = false;\n    this._renderingQueueLaunched = false;\n    this._activeRenderLoops = new Array(); // Lost context\n\n    /**\n     * Observable signaled when a context lost event is raised\n     */\n\n    this.onContextLostObservable = new Observable();\n    /**\n     * Observable signaled when a context restored event is raised\n     */\n\n    this.onContextRestoredObservable = new Observable();\n    this._contextWasLost = false;\n    /** @internal */\n\n    this._doNotHandleContextLost = false;\n    /**\n     * Gets or sets a boolean indicating that vertex array object must be disabled even if they are supported\n     */\n\n    this.disableVertexArrayObjects = false; // States\n\n    /** @internal */\n\n    this._colorWrite = true;\n    /** @internal */\n\n    this._colorWriteChanged = true;\n    /** @internal */\n\n    this._depthCullingState = new DepthCullingState();\n    /** @internal */\n\n    this._stencilStateComposer = new StencilStateComposer();\n    /** @internal */\n\n    this._stencilState = new StencilState();\n    /** @internal */\n\n    this._alphaState = new AlphaState();\n    /** @internal */\n\n    this._alphaMode = 1;\n    /** @internal */\n\n    this._alphaEquation = 0; // Cache\n\n    /** @internal */\n\n    this._internalTexturesCache = new Array();\n    /** @internal */\n\n    this._renderTargetWrapperCache = new Array();\n    /** @internal */\n\n    this._activeChannel = 0;\n    this._currentTextureChannel = -1;\n    /** @internal */\n\n    this._boundTexturesCache = {};\n    this._compiledEffects = {};\n    this._vertexAttribArraysEnabled = [];\n    this._uintIndicesCurrentlySet = false;\n    this._currentBoundBuffer = new Array();\n    /** @internal */\n\n    this._currentFramebuffer = null;\n    /** @internal */\n\n    this._dummyFramebuffer = null;\n    this._currentBufferPointers = new Array();\n    this._currentInstanceLocations = new Array();\n    this._currentInstanceBuffers = new Array();\n    this._vaoRecordInProgress = false;\n    this._mustWipeVertexAttributes = false;\n    this._nextFreeTextureSlots = new Array();\n    this._maxSimultaneousTextures = 0;\n    this._maxMSAASamplesOverride = null;\n    this._activeRequests = new Array();\n    /**\n     * If set to true zooming in and out in the browser will rescale the hardware-scaling correctly.\n     */\n\n    this.adaptToDeviceRatio = false;\n    /** @internal */\n\n    this._lastDevicePixelRatio = 1.0;\n    /** @internal */\n\n    this._transformTextureUrl = null;\n    /**\n     * Gets information about the current host\n     */\n\n    this.hostInformation = {\n      isMobile: false\n    };\n    /**\n     * Defines whether the engine has been created with the premultipliedAlpha option on or not.\n     */\n\n    this.premultipliedAlpha = true;\n    /**\n     * Observable event triggered before each texture is initialized\n     */\n\n    this.onBeforeTextureInitObservable = new Observable();\n    /** @internal */\n\n    this._isWebGPU = false;\n    this._snapshotRenderingMode = 0;\n    this._useExactSrgbConversions = false;\n    this._viewportCached = {\n      x: 0,\n      y: 0,\n      z: 0,\n      w: 0\n    };\n    this._unpackFlipYCached = null;\n    /**\n     * In case you are sharing the context with other applications, it might\n     * be interested to not cache the unpack flip y state to ensure a consistent\n     * value would be set.\n     */\n\n    this.enableUnpackFlipYCached = true;\n    this._boundUniforms = {};\n    var canvas = null;\n    options = options || {};\n    this._creationOptions = options; // Save this off for use in resize().\n\n    this.adaptToDeviceRatio = (_adaptToDeviceRatio = adaptToDeviceRatio) !== null && _adaptToDeviceRatio !== void 0 ? _adaptToDeviceRatio : false;\n    this._stencilStateComposer.stencilGlobal = this._stencilState;\n    PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n\n    if (!canvasOrContext) {\n      return;\n    }\n\n    adaptToDeviceRatio = adaptToDeviceRatio || options.adaptToDeviceRatio || false;\n\n    if (canvasOrContext.getContext) {\n      canvas = canvasOrContext;\n      this._renderingCanvas = canvas;\n\n      if (antialias !== undefined) {\n        options.antialias = antialias;\n      }\n\n      if (options.deterministicLockstep === undefined) {\n        options.deterministicLockstep = false;\n      }\n\n      if (options.lockstepMaxSteps === undefined) {\n        options.lockstepMaxSteps = 4;\n      }\n\n      if (options.timeStep === undefined) {\n        options.timeStep = 1 / 60;\n      }\n\n      if (options.preserveDrawingBuffer === undefined) {\n        options.preserveDrawingBuffer = false;\n      }\n\n      if (options.audioEngine === undefined) {\n        options.audioEngine = true;\n      }\n\n      if (options.audioEngineOptions !== undefined && options.audioEngineOptions.audioContext !== undefined) {\n        this._audioContext = options.audioEngineOptions.audioContext;\n      }\n\n      if (options.audioEngineOptions !== undefined && options.audioEngineOptions.audioDestination !== undefined) {\n        this._audioDestination = options.audioEngineOptions.audioDestination;\n      }\n\n      if (options.stencil === undefined) {\n        options.stencil = true;\n      }\n\n      if (options.premultipliedAlpha === false) {\n        this.premultipliedAlpha = false;\n      }\n\n      if (options.xrCompatible === undefined) {\n        options.xrCompatible = true;\n      }\n\n      if (options.useExactSrgbConversions !== undefined) {\n        this._useExactSrgbConversions = options.useExactSrgbConversions;\n      }\n\n      this._doNotHandleContextLost = options.doNotHandleContextLost ? true : false; // Exceptions\n\n      if (navigator && navigator.userAgent) {\n        // Function to check if running on mobile device\n        this._checkForMobile = function () {\n          var currentUA = navigator.userAgent;\n          _this.hostInformation.isMobile = currentUA.indexOf(\"Mobile\") !== -1 || // Needed for iOS 13+ detection on iPad (inspired by solution from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios)\n          currentUA.indexOf(\"Mac\") !== -1 && IsDocumentAvailable() && \"ontouchend\" in document;\n        }; // Set initial isMobile value\n\n\n        this._checkForMobile(); // Set up event listener to check when window is resized (used to get emulator activation to work properly)\n\n\n        if (IsWindowObjectExist()) {\n          window.addEventListener(\"resize\", this._checkForMobile);\n        }\n\n        var ua = navigator.userAgent;\n\n        var _iterator = _createForOfIteratorHelper(ThinEngine.ExceptionList),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var exception = _step.value;\n            var key = exception.key;\n            var targets = exception.targets;\n            var check = new RegExp(key);\n\n            if (check.test(ua)) {\n              if (exception.capture && exception.captureConstraint) {\n                var capture = exception.capture;\n                var constraint = exception.captureConstraint;\n                var regex = new RegExp(capture);\n                var matches = regex.exec(ua);\n\n                if (matches && matches.length > 0) {\n                  var capturedValue = parseInt(matches[matches.length - 1]);\n\n                  if (capturedValue >= constraint) {\n                    continue;\n                  }\n                }\n              }\n\n              var _iterator2 = _createForOfIteratorHelper(targets),\n                  _step2;\n\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  var target = _step2.value;\n\n                  switch (target) {\n                    case \"uniformBuffer\":\n                      this.disableUniformBuffers = true;\n                      break;\n\n                    case \"vao\":\n                      this.disableVertexArrayObjects = true;\n                      break;\n\n                    case \"antialias\":\n                      options.antialias = false;\n                      break;\n\n                    case \"maxMSAASamples\":\n                      this._maxMSAASamplesOverride = 1;\n                      break;\n                  }\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      } // Context lost\n\n\n      if (!this._doNotHandleContextLost) {\n        this._onContextLost = function (evt) {\n          evt.preventDefault();\n          _this._contextWasLost = true;\n          Logger.Warn(\"WebGL context lost.\");\n\n          _this.onContextLostObservable.notifyObservers(_this);\n        };\n\n        this._onContextRestored = function () {\n          _this._restoreEngineAfterContextLost(_this._initGLContext.bind(_this));\n        };\n\n        canvas.addEventListener(\"webglcontextlost\", this._onContextLost, false);\n        canvas.addEventListener(\"webglcontextrestored\", this._onContextRestored, false);\n        options.powerPreference = \"high-performance\";\n      } // Detect if we are running on a faulty buggy desktop OS.\n\n\n      this._badDesktopOS = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n\n      if (this._badDesktopOS) {\n        options.xrCompatible = false;\n      } // GL\n\n\n      if (!options.disableWebGL2Support) {\n        try {\n          this._gl = canvas.getContext(\"webgl2\", options) || canvas.getContext(\"experimental-webgl2\", options);\n\n          if (this._gl) {\n            this._webGLVersion = 2.0;\n            this._shaderPlatformName = \"WEBGL2\"; // Prevent weird browsers to lie (yeah that happens!)\n\n            if (!this._gl.deleteQuery) {\n              this._webGLVersion = 1.0;\n              this._shaderPlatformName = \"WEBGL1\";\n            }\n          }\n        } catch (e) {// Do nothing\n        }\n      }\n\n      if (!this._gl) {\n        if (!canvas) {\n          throw new Error(\"The provided canvas is null or undefined.\");\n        }\n\n        try {\n          this._gl = canvas.getContext(\"webgl\", options) || canvas.getContext(\"experimental-webgl\", options);\n        } catch (e) {\n          throw new Error(\"WebGL not supported\");\n        }\n      }\n\n      if (!this._gl) {\n        throw new Error(\"WebGL not supported\");\n      }\n    } else {\n      this._gl = canvasOrContext;\n      this._renderingCanvas = this._gl.canvas;\n\n      if (this._gl.renderbufferStorageMultisample) {\n        this._webGLVersion = 2.0;\n        this._shaderPlatformName = \"WEBGL2\";\n      } else {\n        this._shaderPlatformName = \"WEBGL1\";\n      }\n\n      var attributes = this._gl.getContextAttributes();\n\n      if (attributes) {\n        options.stencil = attributes.stencil;\n      }\n    } // Ensures a consistent color space unpacking of textures cross browser.\n\n\n    this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n\n    if (options.useHighPrecisionFloats !== undefined) {\n      this._highPrecisionShadersAllowed = options.useHighPrecisionFloats;\n    } // Viewport\n\n\n    var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n    var limitDeviceRatio = options.limitDeviceRatio || devicePixelRatio;\n    this._hardwareScalingLevel = adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio) : 1.0;\n    this._lastDevicePixelRatio = devicePixelRatio;\n    this.resize();\n    this._isStencilEnable = options.stencil ? true : false;\n\n    this._initGLContext();\n\n    this._initFeatures(); // Prepare buffer pointers\n\n\n    for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n      this._currentBufferPointers[i] = new BufferPointer();\n    } // Shader processor\n\n\n    this._shaderProcessor = this.webGLVersion > 1 ? new WebGL2ShaderProcessor() : new WebGLShaderProcessor(); // Detect if we are running on a faulty buggy OS.\n\n    this._badOS = /iPad/i.test(navigator.userAgent) || /iPhone/i.test(navigator.userAgent); // Starting with iOS 14, we can trust the browser\n    // let matches = navigator.userAgent.match(/Version\\/(\\d+)/);\n    // if (matches && matches.length === 2) {\n    //     if (parseInt(matches[1]) >= 14) {\n    //         this._badOS = false;\n    //     }\n    // }\n\n    var versionToLog = \"Babylon.js v\".concat(ThinEngine.Version);\n    console.log(versionToLog + \" - \".concat(this.description)); // Check setAttribute in case of workers\n\n    if (this._renderingCanvas && this._renderingCanvas.setAttribute) {\n      this._renderingCanvas.setAttribute(\"data-engine\", versionToLog);\n    }\n  }\n  /**\n   * Returns the current npm package of the sdk\n   */\n  // Not mixed with Version for tooling purpose.\n\n\n  _createClass(ThinEngine, [{\n    key: \"description\",\n    get:\n    /**\n     * Returns a string describing the current engine\n     */\n    function get() {\n      var description = this.name + this.webGLVersion;\n\n      if (this._caps.parallelShaderCompile) {\n        description += \" - Parallel shader compilation\";\n      }\n\n      return description;\n    }\n    /**\n     * Gets or sets the name of the engine\n     */\n\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this._name;\n    },\n    set: function set(value) {\n      this._name = value;\n    }\n    /**\n     * Returns the version of the engine\n     */\n\n  }, {\n    key: \"version\",\n    get: function get() {\n      return this._webGLVersion;\n    }\n    /**\n     * Gets or sets the relative url used to load shaders if using the engine in non-minified mode\n     */\n\n  }, {\n    key: \"_getShaderProcessor\",\n    value:\n    /**\n     * @internal\n     */\n    function _getShaderProcessor(shaderLanguage) {\n      return this._shaderProcessor;\n    }\n    /**\n     * Gets or sets a boolean indicating if depth buffer should be reverse, going from far to near.\n     * This can provide greater z depth for distant objects.\n     */\n\n  }, {\n    key: \"useReverseDepthBuffer\",\n    get: function get() {\n      return this._useReverseDepthBuffer;\n    },\n    set: function set(useReverse) {\n      if (useReverse === this._useReverseDepthBuffer) {\n        return;\n      }\n\n      this._useReverseDepthBuffer = useReverse;\n\n      if (useReverse) {\n        this._depthCullingState.depthFunc = 518;\n      } else {\n        this._depthCullingState.depthFunc = 515;\n      }\n    }\n    /**\n     * Gets the current frame id\n     */\n\n  }, {\n    key: \"frameId\",\n    get: function get() {\n      return this._frameId;\n    }\n    /**\n     * Gets a boolean indicating that the engine supports uniform buffers\n     * @see https://doc.babylonjs.com/features/webgl2#uniform-buffer-objets\n     */\n\n  }, {\n    key: \"supportsUniformBuffers\",\n    get: function get() {\n      return this.webGLVersion > 1 && !this.disableUniformBuffers;\n    }\n    /**\n     * Gets the options used for engine creation\n     * @returns EngineOptions object\n     */\n\n  }, {\n    key: \"getCreationOptions\",\n    value: function getCreationOptions() {\n      return this._creationOptions;\n    }\n    /** @internal */\n\n  }, {\n    key: \"_shouldUseHighPrecisionShader\",\n    get: function get() {\n      return !!(this._caps.highPrecisionShaderSupported && this._highPrecisionShadersAllowed);\n    }\n    /**\n     * Gets a boolean indicating that only power of 2 textures are supported\n     * Please note that you can still use non power of 2 textures but in this case the engine will forcefully convert them\n     */\n\n  }, {\n    key: \"needPOTTextures\",\n    get: function get() {\n      return this._webGLVersion < 2 || this.forcePOTTextures;\n    }\n    /**\n     * Gets the list of current active render loop functions\n     * @returns an array with the current render loop functions\n     */\n\n  }, {\n    key: \"activeRenderLoops\",\n    get: function get() {\n      return this._activeRenderLoops;\n    }\n    /**\n     * Gets or sets a boolean indicating if resources should be retained to be able to handle context lost events\n     * @see https://doc.babylonjs.com/how_to/optimizing_your_scene#handling-webgl-context-lost\n     */\n\n  }, {\n    key: \"doNotHandleContextLost\",\n    get: function get() {\n      return this._doNotHandleContextLost;\n    },\n    set: function set(value) {\n      this._doNotHandleContextLost = value;\n    }\n  }, {\n    key: \"_supportsHardwareTextureRescaling\",\n    get: function get() {\n      return false;\n    }\n    /**\n     * sets the object from which width and height will be taken from when getting render width and height\n     * Will fallback to the gl object\n     * @param dimensions the framebuffer width and height that will be used.\n     */\n\n  }, {\n    key: \"framebufferDimensionsObject\",\n    set: function set(dimensions) {\n      this._framebufferDimensionsObject = dimensions;\n    }\n    /**\n     * Gets the current viewport\n     */\n\n  }, {\n    key: \"currentViewport\",\n    get: function get() {\n      return this._cachedViewport;\n    }\n    /**\n     * Gets the default empty texture\n     */\n\n  }, {\n    key: \"emptyTexture\",\n    get: function get() {\n      if (!this._emptyTexture) {\n        this._emptyTexture = this.createRawTexture(new Uint8Array(4), 1, 1, 5, false, false, 1);\n      }\n\n      return this._emptyTexture;\n    }\n    /**\n     * Gets the default empty 3D texture\n     */\n\n  }, {\n    key: \"emptyTexture3D\",\n    get: function get() {\n      if (!this._emptyTexture3D) {\n        this._emptyTexture3D = this.createRawTexture3D(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n      }\n\n      return this._emptyTexture3D;\n    }\n    /**\n     * Gets the default empty 2D array texture\n     */\n\n  }, {\n    key: \"emptyTexture2DArray\",\n    get: function get() {\n      if (!this._emptyTexture2DArray) {\n        this._emptyTexture2DArray = this.createRawTexture2DArray(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n      }\n\n      return this._emptyTexture2DArray;\n    }\n    /**\n     * Gets the default empty cube texture\n     */\n\n  }, {\n    key: \"emptyCubeTexture\",\n    get: function get() {\n      if (!this._emptyCubeTexture) {\n        var faceData = new Uint8Array(4);\n        var cubeData = [faceData, faceData, faceData, faceData, faceData, faceData];\n        this._emptyCubeTexture = this.createRawCubeTexture(cubeData, 1, 5, 0, false, false, 1);\n      }\n\n      return this._emptyCubeTexture;\n    }\n    /**\n     * Gets a boolean indicating if the engine runs in WebGPU or not.\n     */\n\n  }, {\n    key: \"isWebGPU\",\n    get: function get() {\n      return this._isWebGPU;\n    }\n    /**\n     * Gets the shader platform name used by the effects.\n     */\n\n  }, {\n    key: \"shaderPlatformName\",\n    get: function get() {\n      return this._shaderPlatformName;\n    }\n    /**\n     * Enables or disables the snapshot rendering mode\n     * Note that the WebGL engine does not support snapshot rendering so setting the value won't have any effect for this engine\n     */\n\n  }, {\n    key: \"snapshotRendering\",\n    get: function get() {\n      return false;\n    },\n    set: function set(activate) {// WebGL engine does not support snapshot rendering\n    }\n    /**\n     * Gets or sets the snapshot rendering mode\n     */\n\n  }, {\n    key: \"snapshotRenderingMode\",\n    get: function get() {\n      return this._snapshotRenderingMode;\n    },\n    set: function set(mode) {\n      this._snapshotRenderingMode = mode;\n    }\n    /**\n     * Gets a boolean indicating if the exact sRGB conversions or faster approximations are used for converting to and from linear space.\n     */\n\n  }, {\n    key: \"useExactSrgbConversions\",\n    get: function get() {\n      return this._useExactSrgbConversions;\n    }\n    /**\n     * Creates a new snapshot at the next frame using the current snapshotRenderingMode\n     */\n\n  }, {\n    key: \"snapshotRenderingReset\",\n    value: function snapshotRenderingReset() {\n      this.snapshotRendering = false;\n    }\n  }, {\n    key: \"createCanvas\",\n    value:\n    /**\n     * Create a canvas. This method is overridden by other engines\n     * @param width width\n     * @param height height\n     * @returns ICanvas interface\n     */\n    function createCanvas(width, height) {\n      return ThinEngine._CreateCanvas(width, height);\n    }\n    /**\n     * Create an image to use with canvas\n     * @returns IImage interface\n     */\n\n  }, {\n    key: \"createCanvasImage\",\n    value: function createCanvasImage() {\n      return document.createElement(\"img\");\n    }\n  }, {\n    key: \"_restoreEngineAfterContextLost\",\n    value: function _restoreEngineAfterContextLost(initEngine) {\n      var _this2 = this;\n\n      // Adding a timeout to avoid race condition at browser level\n      setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2$_rebuildComput;\n\n        var depthTest, depthFunc, depthMask, stencilTest;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this2._dummyFramebuffer = null;\n                depthTest = _this2._depthCullingState.depthTest; // backup those values because the call to initEngine / wipeCaches will reset them\n\n                depthFunc = _this2._depthCullingState.depthFunc;\n                depthMask = _this2._depthCullingState.depthMask;\n                stencilTest = _this2._stencilState.stencilTest; // Rebuild context\n\n                _context.next = 7;\n                return initEngine();\n\n              case 7:\n                // Rebuild effects\n                _this2._rebuildEffects();\n\n                (_this2$_rebuildComput = _this2._rebuildComputeEffects) === null || _this2$_rebuildComput === void 0 ? void 0 : _this2$_rebuildComput.call(_this2); // Rebuild textures\n\n                _this2._rebuildInternalTextures(); // Rebuild textures\n\n\n                _this2._rebuildRenderTargetWrappers(); // Rebuild buffers\n\n\n                _this2._rebuildBuffers(); // Cache\n\n\n                _this2.wipeCaches(true);\n\n                _this2._depthCullingState.depthTest = depthTest;\n                _this2._depthCullingState.depthFunc = depthFunc;\n                _this2._depthCullingState.depthMask = depthMask;\n                _this2._stencilState.stencilTest = stencilTest;\n                Logger.Warn(_this2.name + \" context successfully restored.\");\n\n                _this2.onContextRestoredObservable.notifyObservers(_this2);\n\n                _this2._contextWasLost = false;\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      })), 0);\n    }\n    /**\n     * Shared initialization across engines types.\n     * @param canvas The canvas associated with this instance of the engine.\n     * @param doNotHandleTouchAction Defines that engine should ignore modifying touch action attribute and style\n     * @param audioEngine Defines if an audio engine should be created by default\n     */\n\n  }, {\n    key: \"_sharedInit\",\n    value: function _sharedInit(canvas, doNotHandleTouchAction, audioEngine) {\n      this._renderingCanvas = canvas;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getShaderProcessingContext\",\n    value: function _getShaderProcessingContext(shaderLanguage) {\n      return null;\n    }\n  }, {\n    key: \"_rebuildInternalTextures\",\n    value: function _rebuildInternalTextures() {\n      var currentState = this._internalTexturesCache.slice(); // Do a copy because the rebuild will add proxies\n\n\n      var _iterator3 = _createForOfIteratorHelper(currentState),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var internalTexture = _step3.value;\n\n          internalTexture._rebuild();\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    }\n  }, {\n    key: \"_rebuildRenderTargetWrappers\",\n    value: function _rebuildRenderTargetWrappers() {\n      var currentState = this._renderTargetWrapperCache.slice(); // Do a copy because the rebuild will add proxies\n\n\n      var _iterator4 = _createForOfIteratorHelper(currentState),\n          _step4;\n\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var renderTargetWrapper = _step4.value;\n\n          renderTargetWrapper._rebuild();\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }, {\n    key: \"_rebuildEffects\",\n    value: function _rebuildEffects() {\n      for (var key in this._compiledEffects) {\n        var effect = this._compiledEffects[key];\n        effect._pipelineContext = null; // because _prepareEffect will try to dispose this pipeline before recreating it and that would lead to webgl errors\n\n        effect._wasPreviouslyReady = false;\n\n        effect._prepareEffect();\n      }\n\n      Effect.ResetCache();\n    }\n    /**\n     * Gets a boolean indicating if all created effects are ready\n     * @returns true if all effects are ready\n     */\n\n  }, {\n    key: \"areAllEffectsReady\",\n    value: function areAllEffectsReady() {\n      for (var key in this._compiledEffects) {\n        var effect = this._compiledEffects[key];\n\n        if (!effect.isReady()) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: \"_rebuildBuffers\",\n    value: function _rebuildBuffers() {\n      // Uniforms\n      var _iterator5 = _createForOfIteratorHelper(this._uniformBuffers),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var uniformBuffer = _step5.value;\n\n          uniformBuffer._rebuild();\n        } // Storage buffers\n\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      var _iterator6 = _createForOfIteratorHelper(this._storageBuffers),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var storageBuffer = _step6.value;\n\n          storageBuffer._rebuild();\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n    }\n  }, {\n    key: \"_initGLContext\",\n    value: function _initGLContext() {\n      // Caps\n      this._caps = {\n        maxTexturesImageUnits: this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),\n        maxCombinedTexturesImageUnits: this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n        maxVertexTextureImageUnits: this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n        maxTextureSize: this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),\n        maxSamples: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_SAMPLES) : 1,\n        maxCubemapTextureSize: this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),\n        maxRenderTextureSize: this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),\n        maxVertexAttribs: this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),\n        maxVaryingVectors: this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),\n        maxFragmentUniformVectors: this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),\n        maxVertexUniformVectors: this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),\n        parallelShaderCompile: this._gl.getExtension(\"KHR_parallel_shader_compile\") || undefined,\n        standardDerivatives: this._webGLVersion > 1 || this._gl.getExtension(\"OES_standard_derivatives\") !== null,\n        maxAnisotropy: 1,\n        astc: this._gl.getExtension(\"WEBGL_compressed_texture_astc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_astc\"),\n        bptc: this._gl.getExtension(\"EXT_texture_compression_bptc\") || this._gl.getExtension(\"WEBKIT_EXT_texture_compression_bptc\"),\n        s3tc: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\"),\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        s3tc_srgb: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc_srgb\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc_srgb\"),\n        pvrtc: this._gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\"),\n        etc1: this._gl.getExtension(\"WEBGL_compressed_texture_etc1\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc1\"),\n        etc2: this._gl.getExtension(\"WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBGL_compressed_texture_es3_0\"),\n        textureAnisotropicFilterExtension: this._gl.getExtension(\"EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\"),\n        uintIndices: this._webGLVersion > 1 || this._gl.getExtension(\"OES_element_index_uint\") !== null,\n        fragmentDepthSupported: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_frag_depth\") !== null,\n        highPrecisionShaderSupported: false,\n        timerQuery: this._gl.getExtension(\"EXT_disjoint_timer_query_webgl2\") || this._gl.getExtension(\"EXT_disjoint_timer_query\"),\n        supportOcclusionQuery: this._webGLVersion > 1,\n        canUseTimestampForTimerQuery: false,\n        drawBuffersExtension: false,\n        maxMSAASamples: 1,\n        colorBufferFloat: !!(this._webGLVersion > 1 && this._gl.getExtension(\"EXT_color_buffer_float\")),\n        textureFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_float\") ? true : false,\n        textureHalfFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_half_float\") ? true : false,\n        textureHalfFloatRender: false,\n        textureFloatLinearFiltering: false,\n        textureFloatRender: false,\n        textureHalfFloatLinearFiltering: false,\n        vertexArrayObject: false,\n        instancedArrays: false,\n        textureLOD: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_shader_texture_lod\") ? true : false,\n        blendMinMax: false,\n        multiview: this._gl.getExtension(\"OVR_multiview2\"),\n        oculusMultiview: this._gl.getExtension(\"OCULUS_multiview\"),\n        depthTextureExtension: false,\n        canUseGLInstanceID: this._webGLVersion > 1,\n        canUseGLVertexID: this._webGLVersion > 1,\n        supportComputeShaders: false,\n        supportSRGBBuffers: false,\n        supportTransformFeedbacks: this._webGLVersion > 1,\n        textureMaxLevel: this._webGLVersion > 1,\n        texture2DArrayMaxLayerCount: this._webGLVersion > 1 ? 256 : 128\n      }; // Infos\n\n      this._glVersion = this._gl.getParameter(this._gl.VERSION);\n\n      var rendererInfo = this._gl.getExtension(\"WEBGL_debug_renderer_info\");\n\n      if (rendererInfo != null) {\n        this._glRenderer = this._gl.getParameter(rendererInfo.UNMASKED_RENDERER_WEBGL);\n        this._glVendor = this._gl.getParameter(rendererInfo.UNMASKED_VENDOR_WEBGL);\n      }\n\n      if (!this._glVendor) {\n        this._glVendor = this._gl.getParameter(this._gl.VENDOR) || \"Unknown vendor\";\n      }\n\n      if (!this._glRenderer) {\n        this._glRenderer = this._gl.getParameter(this._gl.RENDERER) || \"Unknown renderer\";\n      } // Constants\n\n\n      if (this._gl.HALF_FLOAT_OES !== 0x8d61) {\n        this._gl.HALF_FLOAT_OES = 0x8d61; // Half floating-point type (16-bit).\n      }\n\n      if (this._gl.RGBA16F !== 0x881a) {\n        this._gl.RGBA16F = 0x881a; // RGBA 16-bit floating-point color-renderable internal sized format.\n      }\n\n      if (this._gl.RGBA32F !== 0x8814) {\n        this._gl.RGBA32F = 0x8814; // RGBA 32-bit floating-point color-renderable internal sized format.\n      }\n\n      if (this._gl.DEPTH24_STENCIL8 !== 35056) {\n        this._gl.DEPTH24_STENCIL8 = 35056;\n      } // Extensions\n\n\n      if (this._caps.timerQuery) {\n        var _this$_gl$getQuery;\n\n        if (this._webGLVersion === 1) {\n          this._gl.getQuery = this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery);\n        }\n\n        this._caps.canUseTimestampForTimerQuery = ((_this$_gl$getQuery = this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT, this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)) !== null && _this$_gl$getQuery !== void 0 ? _this$_gl$getQuery : 0) > 0;\n      }\n\n      this._caps.maxAnisotropy = this._caps.textureAnisotropicFilterExtension ? this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\n      this._caps.textureFloatLinearFiltering = this._caps.textureFloat && this._gl.getExtension(\"OES_texture_float_linear\") ? true : false;\n      this._caps.textureFloatRender = this._caps.textureFloat && this._canRenderToFloatFramebuffer() ? true : false;\n      this._caps.textureHalfFloatLinearFiltering = this._webGLVersion > 1 || this._caps.textureHalfFloat && this._gl.getExtension(\"OES_texture_half_float_linear\") ? true : false; // Compressed formats\n\n      if (this._caps.astc) {\n        this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR = this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n      }\n\n      if (this._caps.bptc) {\n        this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT = this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n      }\n\n      if (this._caps.s3tc_srgb) {\n        this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n        this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n        this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n      }\n\n      if (this._caps.etc2) {\n        this._gl.COMPRESSED_SRGB8_ETC2 = this._caps.etc2.COMPRESSED_SRGB8_ETC2;\n        this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC = this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n      } // Checks if some of the format renders first to allow the use of webgl inspector.\n\n\n      if (this._webGLVersion > 1) {\n        if (this._gl.HALF_FLOAT_OES !== 0x140b) {\n          this._gl.HALF_FLOAT_OES = 0x140b;\n        }\n      }\n\n      this._caps.textureHalfFloatRender = this._caps.textureHalfFloat && this._canRenderToHalfFloatFramebuffer(); // Draw buffers\n\n      if (this._webGLVersion > 1) {\n        this._caps.drawBuffersExtension = true;\n        this._caps.maxMSAASamples = this._maxMSAASamplesOverride !== null ? this._maxMSAASamplesOverride : this._gl.getParameter(this._gl.MAX_SAMPLES);\n      } else {\n        var drawBuffersExtension = this._gl.getExtension(\"WEBGL_draw_buffers\");\n\n        if (drawBuffersExtension !== null) {\n          this._caps.drawBuffersExtension = true;\n          this._gl.drawBuffers = drawBuffersExtension.drawBuffersWEBGL.bind(drawBuffersExtension);\n          this._gl.DRAW_FRAMEBUFFER = this._gl.FRAMEBUFFER;\n\n          for (var i = 0; i < 16; i++) {\n            this._gl[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"] = drawBuffersExtension[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n          }\n        }\n      } // Depth Texture\n\n\n      if (this._webGLVersion > 1) {\n        this._caps.depthTextureExtension = true;\n      } else {\n        var depthTextureExtension = this._gl.getExtension(\"WEBGL_depth_texture\");\n\n        if (depthTextureExtension != null) {\n          this._caps.depthTextureExtension = true;\n          this._gl.UNSIGNED_INT_24_8 = depthTextureExtension.UNSIGNED_INT_24_8_WEBGL;\n        }\n      } // Vertex array object\n\n\n      if (this.disableVertexArrayObjects) {\n        this._caps.vertexArrayObject = false;\n      } else if (this._webGLVersion > 1) {\n        this._caps.vertexArrayObject = true;\n      } else {\n        var vertexArrayObjectExtension = this._gl.getExtension(\"OES_vertex_array_object\");\n\n        if (vertexArrayObjectExtension != null) {\n          this._caps.vertexArrayObject = true;\n          this._gl.createVertexArray = vertexArrayObjectExtension.createVertexArrayOES.bind(vertexArrayObjectExtension);\n          this._gl.bindVertexArray = vertexArrayObjectExtension.bindVertexArrayOES.bind(vertexArrayObjectExtension);\n          this._gl.deleteVertexArray = vertexArrayObjectExtension.deleteVertexArrayOES.bind(vertexArrayObjectExtension);\n        }\n      } // Instances count\n\n\n      if (this._webGLVersion > 1) {\n        this._caps.instancedArrays = true;\n      } else {\n        var instanceExtension = this._gl.getExtension(\"ANGLE_instanced_arrays\");\n\n        if (instanceExtension != null) {\n          this._caps.instancedArrays = true;\n          this._gl.drawArraysInstanced = instanceExtension.drawArraysInstancedANGLE.bind(instanceExtension);\n          this._gl.drawElementsInstanced = instanceExtension.drawElementsInstancedANGLE.bind(instanceExtension);\n          this._gl.vertexAttribDivisor = instanceExtension.vertexAttribDivisorANGLE.bind(instanceExtension);\n        } else {\n          this._caps.instancedArrays = false;\n        }\n      }\n\n      if (this._gl.getShaderPrecisionFormat) {\n        var vertexhighp = this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER, this._gl.HIGH_FLOAT);\n\n        var fragmenthighp = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);\n\n        if (vertexhighp && fragmenthighp) {\n          this._caps.highPrecisionShaderSupported = vertexhighp.precision !== 0 && fragmenthighp.precision !== 0;\n        }\n      }\n\n      if (this._webGLVersion > 1) {\n        this._caps.blendMinMax = true;\n      } else {\n        var blendMinMaxExtension = this._gl.getExtension(\"EXT_blend_minmax\");\n\n        if (blendMinMaxExtension != null) {\n          this._caps.blendMinMax = true;\n          this._gl.MAX = blendMinMaxExtension.MAX_EXT;\n          this._gl.MIN = blendMinMaxExtension.MIN_EXT;\n        }\n      } // sRGB buffers\n      // only run this if not already set to true (in the constructor, for example)\n\n\n      if (!this._caps.supportSRGBBuffers) {\n        if (this._webGLVersion > 1) {\n          this._caps.supportSRGBBuffers = true;\n        } else {\n          var sRGBExtension = this._gl.getExtension(\"EXT_sRGB\");\n\n          if (sRGBExtension != null) {\n            this._caps.supportSRGBBuffers = true;\n            this._gl.SRGB = sRGBExtension.SRGB_EXT;\n            this._gl.SRGB8 = sRGBExtension.SRGB_ALPHA_EXT;\n            this._gl.SRGB8_ALPHA8 = sRGBExtension.SRGB_ALPHA_EXT;\n          }\n        } // take into account the forced state that was provided in options\n        // When the issue in angle/chrome is fixed the flag should be taken into account only when it is explicitly defined\n\n\n        this._caps.supportSRGBBuffers = this._caps.supportSRGBBuffers && !!(this._creationOptions && this._creationOptions.forceSRGBBufferSupportState);\n      } // Depth buffer\n\n\n      this._depthCullingState.depthTest = true;\n      this._depthCullingState.depthFunc = this._gl.LEQUAL;\n      this._depthCullingState.depthMask = true; // Texture maps\n\n      this._maxSimultaneousTextures = this._caps.maxCombinedTexturesImageUnits;\n\n      for (var slot = 0; slot < this._maxSimultaneousTextures; slot++) {\n        this._nextFreeTextureSlots.push(slot);\n      }\n    }\n  }, {\n    key: \"_initFeatures\",\n    value: function _initFeatures() {\n      this._features = {\n        forceBitmapOverHTMLImageElement: false,\n        supportRenderAndCopyToLodForFloatTextures: this._webGLVersion !== 1,\n        supportDepthStencilTexture: this._webGLVersion !== 1,\n        supportShadowSamplers: this._webGLVersion !== 1,\n        uniformBufferHardCheckMatrix: false,\n        allowTexturePrefiltering: this._webGLVersion !== 1,\n        trackUbosInFrame: false,\n        checkUbosContentBeforeUpload: false,\n        supportCSM: this._webGLVersion !== 1,\n        basisNeedsPOT: this._webGLVersion === 1,\n        support3DTextures: this._webGLVersion !== 1,\n        needTypeSuffixInShaderConstants: this._webGLVersion !== 1,\n        supportMSAA: this._webGLVersion !== 1,\n        supportSSAO2: this._webGLVersion !== 1,\n        supportExtendedTextureFormats: this._webGLVersion !== 1,\n        supportSwitchCaseInShader: this._webGLVersion !== 1,\n        supportSyncTextureRead: true,\n        needsInvertingBitmap: true,\n        useUBOBindingCache: true,\n        needShaderCodeInlining: false,\n        needToAlwaysBindUniformBuffers: false,\n        supportRenderPasses: false,\n        supportSpriteInstancing: true,\n        _collectUbosUpdatedInFrame: false\n      };\n    }\n    /**\n     * Gets version of the current webGL context\n     * Keep it for back compat - use version instead\n     */\n\n  }, {\n    key: \"webGLVersion\",\n    get: function get() {\n      return this._webGLVersion;\n    }\n    /**\n     * Gets a string identifying the name of the class\n     * @returns \"Engine\" string\n     */\n\n  }, {\n    key: \"getClassName\",\n    value: function getClassName() {\n      return \"ThinEngine\";\n    }\n    /**\n     * Returns true if the stencil buffer has been enabled through the creation option of the context.\n     */\n\n  }, {\n    key: \"isStencilEnable\",\n    get: function get() {\n      return this._isStencilEnable;\n    }\n    /** @internal */\n\n  }, {\n    key: \"_prepareWorkingCanvas\",\n    value: function _prepareWorkingCanvas() {\n      if (this._workingCanvas) {\n        return;\n      }\n\n      this._workingCanvas = this.createCanvas(1, 1);\n\n      var context = this._workingCanvas.getContext(\"2d\");\n\n      if (context) {\n        this._workingContext = context;\n      }\n    }\n    /**\n     * Reset the texture cache to empty state\n     */\n\n  }, {\n    key: \"resetTextureCache\",\n    value: function resetTextureCache() {\n      for (var key in this._boundTexturesCache) {\n        if (!Object.prototype.hasOwnProperty.call(this._boundTexturesCache, key)) {\n          continue;\n        }\n\n        this._boundTexturesCache[key] = null;\n      }\n\n      this._currentTextureChannel = -1;\n    }\n    /**\n     * Gets an object containing information about the current engine context\n     * @returns an object containing the vendor, the renderer and the version of the current engine context\n     */\n\n  }, {\n    key: \"getInfo\",\n    value: function getInfo() {\n      return this.getGlInfo();\n    }\n    /**\n     * Gets an object containing information about the current webGL context\n     * @returns an object containing the vendor, the renderer and the version of the current webGL context\n     */\n\n  }, {\n    key: \"getGlInfo\",\n    value: function getGlInfo() {\n      return {\n        vendor: this._glVendor,\n        renderer: this._glRenderer,\n        version: this._glVersion\n      };\n    }\n    /**\n     * Defines the hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @param level defines the level to use\n     */\n\n  }, {\n    key: \"setHardwareScalingLevel\",\n    value: function setHardwareScalingLevel(level) {\n      this._hardwareScalingLevel = level;\n      this.resize();\n    }\n    /**\n     * Gets the current hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @returns a number indicating the current hardware scaling level\n     */\n\n  }, {\n    key: \"getHardwareScalingLevel\",\n    value: function getHardwareScalingLevel() {\n      return this._hardwareScalingLevel;\n    }\n    /**\n     * Gets the list of loaded textures\n     * @returns an array containing all loaded textures\n     */\n\n  }, {\n    key: \"getLoadedTexturesCache\",\n    value: function getLoadedTexturesCache() {\n      return this._internalTexturesCache;\n    }\n    /**\n     * Gets the object containing all engine capabilities\n     * @returns the EngineCapabilities object\n     */\n\n  }, {\n    key: \"getCaps\",\n    value: function getCaps() {\n      return this._caps;\n    }\n    /**\n     * stop executing a render loop function and remove it from the execution array\n     * @param renderFunction defines the function to be removed. If not provided all functions will be removed.\n     */\n\n  }, {\n    key: \"stopRenderLoop\",\n    value: function stopRenderLoop(renderFunction) {\n      if (!renderFunction) {\n        this._activeRenderLoops = [];\n        return;\n      }\n\n      var index = this._activeRenderLoops.indexOf(renderFunction);\n\n      if (index >= 0) {\n        this._activeRenderLoops.splice(index, 1);\n      }\n    }\n    /** @internal */\n\n  }, {\n    key: \"_renderLoop\",\n    value: function _renderLoop() {\n      if (!this._contextWasLost) {\n        var shouldRender = true;\n\n        if (!this.renderEvenInBackground && this._windowIsBackground) {\n          shouldRender = false;\n        }\n\n        if (shouldRender) {\n          // Start new frame\n          this.beginFrame();\n\n          for (var index = 0; index < this._activeRenderLoops.length; index++) {\n            var renderFunction = this._activeRenderLoops[index];\n            renderFunction();\n          } // Present\n\n\n          this.endFrame();\n        }\n      }\n\n      if (this._activeRenderLoops.length > 0) {\n        this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n      } else {\n        this._renderingQueueLaunched = false;\n      }\n    }\n    /**\n     * Gets the HTML canvas attached with the current webGL context\n     * @returns a HTML canvas\n     */\n\n  }, {\n    key: \"getRenderingCanvas\",\n    value: function getRenderingCanvas() {\n      return this._renderingCanvas;\n    }\n    /**\n     * Gets the audio context specified in engine initialization options\n     * @returns an Audio Context\n     */\n\n  }, {\n    key: \"getAudioContext\",\n    value: function getAudioContext() {\n      return this._audioContext;\n    }\n    /**\n     * Gets the audio destination specified in engine initialization options\n     * @returns an audio destination node\n     */\n\n  }, {\n    key: \"getAudioDestination\",\n    value: function getAudioDestination() {\n      return this._audioDestination;\n    }\n    /**\n     * Gets host window\n     * @returns the host window object\n     */\n\n  }, {\n    key: \"getHostWindow\",\n    value: function getHostWindow() {\n      if (!IsWindowObjectExist()) {\n        return null;\n      }\n\n      if (this._renderingCanvas && this._renderingCanvas.ownerDocument && this._renderingCanvas.ownerDocument.defaultView) {\n        return this._renderingCanvas.ownerDocument.defaultView;\n      }\n\n      return window;\n    }\n    /**\n     * Gets the current render width\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render width\n     */\n\n  }, {\n    key: \"getRenderWidth\",\n    value: function getRenderWidth() {\n      var useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!useScreen && this._currentRenderTarget) {\n        return this._currentRenderTarget.width;\n      }\n\n      return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferWidth : this._gl.drawingBufferWidth;\n    }\n    /**\n     * Gets the current render height\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render height\n     */\n\n  }, {\n    key: \"getRenderHeight\",\n    value: function getRenderHeight() {\n      var useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!useScreen && this._currentRenderTarget) {\n        return this._currentRenderTarget.height;\n      }\n\n      return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferHeight : this._gl.drawingBufferHeight;\n    }\n    /**\n     * Can be used to override the current requestAnimationFrame requester.\n     * @internal\n     */\n\n  }, {\n    key: \"_queueNewFrame\",\n    value: function _queueNewFrame(bindedRenderFunction, requester) {\n      return ThinEngine.QueueNewFrame(bindedRenderFunction, requester);\n    }\n    /**\n     * Register and execute a render loop. The engine can have more than one render function\n     * @param renderFunction defines the function to continuously execute\n     */\n\n  }, {\n    key: \"runRenderLoop\",\n    value: function runRenderLoop(renderFunction) {\n      if (this._activeRenderLoops.indexOf(renderFunction) !== -1) {\n        return;\n      }\n\n      this._activeRenderLoops.push(renderFunction);\n\n      if (!this._renderingQueueLaunched) {\n        this._renderingQueueLaunched = true;\n        this._boundRenderFunction = this._renderLoop.bind(this);\n        this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n      }\n    }\n    /**\n     * Clear the current render buffer or the current render target (if any is set up)\n     * @param color defines the color to use\n     * @param backBuffer defines if the back buffer must be cleared\n     * @param depth defines if the depth buffer must be cleared\n     * @param stencil defines if the stencil buffer must be cleared\n     */\n\n  }, {\n    key: \"clear\",\n    value: function clear(color, backBuffer, depth) {\n      var stencil = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var useStencilGlobalOnly = this.stencilStateComposer.useStencilGlobalOnly;\n      this.stencilStateComposer.useStencilGlobalOnly = true; // make sure the stencil mask is coming from the global stencil and not from a material (effect) which would currently be in effect\n\n      this.applyStates();\n      this.stencilStateComposer.useStencilGlobalOnly = useStencilGlobalOnly;\n      var mode = 0;\n\n      if (backBuffer && color) {\n        this._gl.clearColor(color.r, color.g, color.b, color.a !== undefined ? color.a : 1.0);\n\n        mode |= this._gl.COLOR_BUFFER_BIT;\n      }\n\n      if (depth) {\n        if (this.useReverseDepthBuffer) {\n          this._depthCullingState.depthFunc = this._gl.GEQUAL;\n\n          this._gl.clearDepth(0.0);\n        } else {\n          this._gl.clearDepth(1.0);\n        }\n\n        mode |= this._gl.DEPTH_BUFFER_BIT;\n      }\n\n      if (stencil) {\n        this._gl.clearStencil(0);\n\n        mode |= this._gl.STENCIL_BUFFER_BIT;\n      }\n\n      this._gl.clear(mode);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_viewport\",\n    value: function _viewport(x, y, width, height) {\n      if (x !== this._viewportCached.x || y !== this._viewportCached.y || width !== this._viewportCached.z || height !== this._viewportCached.w) {\n        this._viewportCached.x = x;\n        this._viewportCached.y = y;\n        this._viewportCached.z = width;\n        this._viewportCached.w = height;\n\n        this._gl.viewport(x, y, width, height);\n      }\n    }\n    /**\n     * Set the WebGL's viewport\n     * @param viewport defines the viewport element to be used\n     * @param requiredWidth defines the width required for rendering. If not provided the rendering canvas' width is used\n     * @param requiredHeight defines the height required for rendering. If not provided the rendering canvas' height is used\n     */\n\n  }, {\n    key: \"setViewport\",\n    value: function setViewport(viewport, requiredWidth, requiredHeight) {\n      var width = requiredWidth || this.getRenderWidth();\n      var height = requiredHeight || this.getRenderHeight();\n      var x = viewport.x || 0;\n      var y = viewport.y || 0;\n      this._cachedViewport = viewport;\n\n      this._viewport(x * width, y * height, width * viewport.width, height * viewport.height);\n    }\n    /**\n     * Begin a new frame\n     */\n\n  }, {\n    key: \"beginFrame\",\n    value: function beginFrame() {}\n    /**\n     * Enf the current frame\n     */\n\n  }, {\n    key: \"endFrame\",\n    value: function endFrame() {\n      // Force a flush in case we are using a bad OS.\n      if (this._badOS) {\n        this.flushFramebuffer();\n      }\n\n      this._frameId++;\n    }\n    /**\n     * Resize the view according to the canvas' size\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      var forceSetSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var width;\n      var height; // Requery hardware scaling level to handle zoomed-in resizing.\n\n      if (this.adaptToDeviceRatio) {\n        var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n        var changeRatio = this._lastDevicePixelRatio / devicePixelRatio;\n        this._lastDevicePixelRatio = devicePixelRatio;\n        this._hardwareScalingLevel *= changeRatio;\n      }\n\n      if (IsWindowObjectExist()) {\n        width = this._renderingCanvas ? this._renderingCanvas.clientWidth || this._renderingCanvas.width : window.innerWidth;\n        height = this._renderingCanvas ? this._renderingCanvas.clientHeight || this._renderingCanvas.height : window.innerHeight;\n      } else {\n        width = this._renderingCanvas ? this._renderingCanvas.width : 100;\n        height = this._renderingCanvas ? this._renderingCanvas.height : 100;\n      }\n\n      this.setSize(width / this._hardwareScalingLevel, height / this._hardwareScalingLevel, forceSetSize);\n    }\n    /**\n     * Force a specific size of the canvas\n     * @param width defines the new canvas' width\n     * @param height defines the new canvas' height\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     * @returns true if the size was changed\n     */\n\n  }, {\n    key: \"setSize\",\n    value: function setSize(width, height) {\n      var forceSetSize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (!this._renderingCanvas) {\n        return false;\n      }\n\n      width = width | 0;\n      height = height | 0;\n\n      if (!forceSetSize && this._renderingCanvas.width === width && this._renderingCanvas.height === height) {\n        return false;\n      }\n\n      this._renderingCanvas.width = width;\n      this._renderingCanvas.height = height;\n      return true;\n    }\n    /**\n     * Binds the frame buffer to the specified texture.\n     * @param texture The render target wrapper to render to\n     * @param faceIndex The face of the texture to render to in case of cube texture\n     * @param requiredWidth The width of the target to render to\n     * @param requiredHeight The height of the target to render to\n     * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n     * @param lodLevel defines the lod level to bind to the frame buffer\n     * @param layer defines the 2d array index to bind to frame buffer to\n     */\n\n  }, {\n    key: \"bindFramebuffer\",\n    value: function bindFramebuffer(texture) {\n      var faceIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var requiredWidth = arguments.length > 2 ? arguments[2] : undefined;\n      var requiredHeight = arguments.length > 3 ? arguments[3] : undefined;\n      var forceFullscreenViewport = arguments.length > 4 ? arguments[4] : undefined;\n      var lodLevel = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n      var layer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var webglRTWrapper = texture;\n\n      if (this._currentRenderTarget) {\n        this.unBindFramebuffer(this._currentRenderTarget);\n      }\n\n      this._currentRenderTarget = texture;\n\n      this._bindUnboundFramebuffer(webglRTWrapper._MSAAFramebuffer ? webglRTWrapper._MSAAFramebuffer : webglRTWrapper._framebuffer);\n\n      var gl = this._gl;\n\n      if (texture.is2DArray) {\n        var _texture$texture$_har;\n\n        gl.framebufferTextureLayer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, (_texture$texture$_har = texture.texture._hardwareTexture) === null || _texture$texture$_har === void 0 ? void 0 : _texture$texture$_har.underlyingResource, lodLevel, layer);\n      } else if (texture.isCube) {\n        var _texture$texture$_har2;\n\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_texture$texture$_har2 = texture.texture._hardwareTexture) === null || _texture$texture$_har2 === void 0 ? void 0 : _texture$texture$_har2.underlyingResource, lodLevel);\n      }\n\n      var depthStencilTexture = texture._depthStencilTexture;\n\n      if (depthStencilTexture) {\n        var attachment = texture._depthStencilTextureWithStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\n        if (texture.is2DArray) {\n          var _depthStencilTexture$;\n\n          gl.framebufferTextureLayer(gl.FRAMEBUFFER, attachment, (_depthStencilTexture$ = depthStencilTexture._hardwareTexture) === null || _depthStencilTexture$ === void 0 ? void 0 : _depthStencilTexture$.underlyingResource, lodLevel, layer);\n        } else if (texture.isCube) {\n          var _depthStencilTexture$2;\n\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_depthStencilTexture$2 = depthStencilTexture._hardwareTexture) === null || _depthStencilTexture$2 === void 0 ? void 0 : _depthStencilTexture$2.underlyingResource, lodLevel);\n        } else {\n          var _depthStencilTexture$3;\n\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, (_depthStencilTexture$3 = depthStencilTexture._hardwareTexture) === null || _depthStencilTexture$3 === void 0 ? void 0 : _depthStencilTexture$3.underlyingResource, lodLevel);\n        }\n      }\n\n      if (this._cachedViewport && !forceFullscreenViewport) {\n        this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n      } else {\n        if (!requiredWidth) {\n          requiredWidth = texture.width;\n\n          if (lodLevel) {\n            requiredWidth = requiredWidth / Math.pow(2, lodLevel);\n          }\n        }\n\n        if (!requiredHeight) {\n          requiredHeight = texture.height;\n\n          if (lodLevel) {\n            requiredHeight = requiredHeight / Math.pow(2, lodLevel);\n          }\n        }\n\n        this._viewport(0, 0, requiredWidth, requiredHeight);\n      }\n\n      this.wipeCaches();\n    }\n    /**\n     * Set various states to the webGL context\n     * @param culling defines culling state: true to enable culling, false to disable it\n     * @param zOffset defines the value to apply to zOffset (0 by default)\n     * @param force defines if states must be applied even if cache is up to date\n     * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n     * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n     * @param stencil stencil states to set\n     * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n     */\n\n  }, {\n    key: \"setState\",\n    value: function setState(culling) {\n      var _ref2, _this$cullBackFaces;\n\n      var zOffset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var force = arguments.length > 2 ? arguments[2] : undefined;\n      var reverseSide = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var cullBackFaces = arguments.length > 4 ? arguments[4] : undefined;\n      var stencil = arguments.length > 5 ? arguments[5] : undefined;\n      var zOffsetUnits = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n\n      // Culling\n      if (this._depthCullingState.cull !== culling || force) {\n        this._depthCullingState.cull = culling;\n      } // Cull face\n\n\n      var cullFace = ((_ref2 = (_this$cullBackFaces = this.cullBackFaces) !== null && _this$cullBackFaces !== void 0 ? _this$cullBackFaces : cullBackFaces) !== null && _ref2 !== void 0 ? _ref2 : true) ? this._gl.BACK : this._gl.FRONT;\n\n      if (this._depthCullingState.cullFace !== cullFace || force) {\n        this._depthCullingState.cullFace = cullFace;\n      } // Z offset\n\n\n      this.setZOffset(zOffset);\n      this.setZOffsetUnits(zOffsetUnits); // Front face\n\n      var frontFace = reverseSide ? this._gl.CW : this._gl.CCW;\n\n      if (this._depthCullingState.frontFace !== frontFace || force) {\n        this._depthCullingState.frontFace = frontFace;\n      }\n\n      this._stencilStateComposer.stencilMaterial = stencil;\n    }\n    /**\n     * Gets a boolean indicating if depth testing is enabled\n     * @returns the current state\n     */\n\n  }, {\n    key: \"getDepthBuffer\",\n    value: function getDepthBuffer() {\n      return this._depthCullingState.depthTest;\n    }\n    /**\n     * Enable or disable depth buffering\n     * @param enable defines the state to set\n     */\n\n  }, {\n    key: \"setDepthBuffer\",\n    value: function setDepthBuffer(enable) {\n      this._depthCullingState.depthTest = enable;\n    }\n    /**\n     * Set the z offset Factor to apply to current rendering\n     * @param value defines the offset to apply\n     */\n\n  }, {\n    key: \"setZOffset\",\n    value: function setZOffset(value) {\n      this._depthCullingState.zOffset = this.useReverseDepthBuffer ? -value : value;\n    }\n    /**\n     * Gets the current value of the zOffset Factor\n     * @returns the current zOffset Factor state\n     */\n\n  }, {\n    key: \"getZOffset\",\n    value: function getZOffset() {\n      var zOffset = this._depthCullingState.zOffset;\n      return this.useReverseDepthBuffer ? -zOffset : zOffset;\n    }\n    /**\n     * Set the z offset Units to apply to current rendering\n     * @param value defines the offset to apply\n     */\n\n  }, {\n    key: \"setZOffsetUnits\",\n    value: function setZOffsetUnits(value) {\n      this._depthCullingState.zOffsetUnits = this.useReverseDepthBuffer ? -value : value;\n    }\n    /**\n     * Gets the current value of the zOffset Units\n     * @returns the current zOffset Units state\n     */\n\n  }, {\n    key: \"getZOffsetUnits\",\n    value: function getZOffsetUnits() {\n      var zOffsetUnits = this._depthCullingState.zOffsetUnits;\n      return this.useReverseDepthBuffer ? -zOffsetUnits : zOffsetUnits;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_bindUnboundFramebuffer\",\n    value: function _bindUnboundFramebuffer(framebuffer) {\n      if (this._currentFramebuffer !== framebuffer) {\n        this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, framebuffer);\n\n        this._currentFramebuffer = framebuffer;\n      }\n    }\n    /** @internal */\n\n  }, {\n    key: \"_currentFrameBufferIsDefaultFrameBuffer\",\n    value: function _currentFrameBufferIsDefaultFrameBuffer() {\n      return this._currentFramebuffer === null;\n    }\n    /**\n     * Generates the mipmaps for a texture\n     * @param texture texture to generate the mipmaps for\n     */\n\n  }, {\n    key: \"generateMipmaps\",\n    value: function generateMipmaps(texture) {\n      this._bindTextureDirectly(this._gl.TEXTURE_2D, texture, true);\n\n      this._gl.generateMipmap(this._gl.TEXTURE_2D);\n\n      this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n    }\n    /**\n     * Unbind the current render target texture from the webGL context\n     * @param texture defines the render target wrapper to unbind\n     * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n     * @param onBeforeUnbind defines a function which will be called before the effective unbind\n     */\n\n  }, {\n    key: \"unBindFramebuffer\",\n    value: function unBindFramebuffer(texture) {\n      var _texture$texture;\n\n      var disableGenerateMipMaps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var onBeforeUnbind = arguments.length > 2 ? arguments[2] : undefined;\n      var webglRTWrapper = texture;\n      this._currentRenderTarget = null; // If MSAA, we need to bitblt back to main texture\n\n      var gl = this._gl;\n\n      if (webglRTWrapper._MSAAFramebuffer) {\n        if (texture.isMulti) {\n          // This texture is part of a MRT texture, we need to treat all attachments\n          this.unBindMultiColorAttachmentFramebuffer(texture, disableGenerateMipMaps, onBeforeUnbind);\n          return;\n        }\n\n        gl.bindFramebuffer(gl.READ_FRAMEBUFFER, webglRTWrapper._MSAAFramebuffer);\n        gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, webglRTWrapper._framebuffer);\n        gl.blitFramebuffer(0, 0, texture.width, texture.height, 0, 0, texture.width, texture.height, gl.COLOR_BUFFER_BIT, gl.NEAREST);\n      }\n\n      if ((_texture$texture = texture.texture) !== null && _texture$texture !== void 0 && _texture$texture.generateMipMaps && !disableGenerateMipMaps && !texture.isCube) {\n        this.generateMipmaps(texture.texture);\n      }\n\n      if (onBeforeUnbind) {\n        if (webglRTWrapper._MSAAFramebuffer) {\n          // Bind the correct framebuffer\n          this._bindUnboundFramebuffer(webglRTWrapper._framebuffer);\n        }\n\n        onBeforeUnbind();\n      }\n\n      this._bindUnboundFramebuffer(null);\n    }\n    /**\n     * Force a webGL flush (ie. a flush of all waiting webGL commands)\n     */\n\n  }, {\n    key: \"flushFramebuffer\",\n    value: function flushFramebuffer() {\n      this._gl.flush();\n    }\n    /**\n     * Unbind the current render target and bind the default framebuffer\n     */\n\n  }, {\n    key: \"restoreDefaultFramebuffer\",\n    value: function restoreDefaultFramebuffer() {\n      if (this._currentRenderTarget) {\n        this.unBindFramebuffer(this._currentRenderTarget);\n      } else {\n        this._bindUnboundFramebuffer(null);\n      }\n\n      if (this._cachedViewport) {\n        this.setViewport(this._cachedViewport);\n      }\n\n      this.wipeCaches();\n    } // VBOs\n\n    /** @internal */\n\n  }, {\n    key: \"_resetVertexBufferBinding\",\n    value: function _resetVertexBufferBinding() {\n      this.bindArrayBuffer(null);\n      this._cachedVertexBuffers = null;\n    }\n    /**\n     * Creates a vertex buffer\n     * @param data the data for the vertex buffer\n     * @returns the new WebGL static buffer\n     */\n\n  }, {\n    key: \"createVertexBuffer\",\n    value: function createVertexBuffer(data) {\n      return this._createVertexBuffer(data, this._gl.STATIC_DRAW);\n    }\n  }, {\n    key: \"_createVertexBuffer\",\n    value: function _createVertexBuffer(data, usage) {\n      var vbo = this._gl.createBuffer();\n\n      if (!vbo) {\n        throw new Error(\"Unable to create vertex buffer\");\n      }\n\n      var dataBuffer = new WebGLDataBuffer(vbo);\n      this.bindArrayBuffer(dataBuffer);\n\n      if (data instanceof Array) {\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(data), usage);\n      } else {\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, data, usage);\n      }\n\n      this._resetVertexBufferBinding();\n\n      dataBuffer.references = 1;\n      return dataBuffer;\n    }\n    /**\n     * Creates a dynamic vertex buffer\n     * @param data the data for the dynamic vertex buffer\n     * @returns the new WebGL dynamic buffer\n     */\n\n  }, {\n    key: \"createDynamicVertexBuffer\",\n    value: function createDynamicVertexBuffer(data) {\n      return this._createVertexBuffer(data, this._gl.DYNAMIC_DRAW);\n    }\n  }, {\n    key: \"_resetIndexBufferBinding\",\n    value: function _resetIndexBufferBinding() {\n      this.bindIndexBuffer(null);\n      this._cachedIndexBuffer = null;\n    }\n    /**\n     * Creates a new index buffer\n     * @param indices defines the content of the index buffer\n     * @param updatable defines if the index buffer must be updatable\n     * @returns a new webGL buffer\n     */\n\n  }, {\n    key: \"createIndexBuffer\",\n    value: function createIndexBuffer(indices, updatable) {\n      var vbo = this._gl.createBuffer();\n\n      var dataBuffer = new WebGLDataBuffer(vbo);\n\n      if (!vbo) {\n        throw new Error(\"Unable to create index buffer\");\n      }\n\n      this.bindIndexBuffer(dataBuffer);\n\n      var data = this._normalizeIndexData(indices);\n\n      this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, updatable ? this._gl.DYNAMIC_DRAW : this._gl.STATIC_DRAW);\n\n      this._resetIndexBufferBinding();\n\n      dataBuffer.references = 1;\n      dataBuffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n      return dataBuffer;\n    }\n  }, {\n    key: \"_normalizeIndexData\",\n    value: function _normalizeIndexData(indices) {\n      var bytesPerElement = indices.BYTES_PER_ELEMENT;\n\n      if (bytesPerElement === 2) {\n        return indices;\n      } // Check 32 bit support\n\n\n      if (this._caps.uintIndices) {\n        if (indices instanceof Uint32Array) {\n          return indices;\n        } else {\n          // number[] or Int32Array, check if 32 bit is necessary\n          for (var index = 0; index < indices.length; index++) {\n            if (indices[index] >= 65535) {\n              return new Uint32Array(indices);\n            }\n          }\n\n          return new Uint16Array(indices);\n        }\n      } // No 32 bit support, force conversion to 16 bit (values greater 16 bit are lost)\n\n\n      return new Uint16Array(indices);\n    }\n    /**\n     * Bind a webGL buffer to the webGL context\n     * @param buffer defines the buffer to bind\n     */\n\n  }, {\n    key: \"bindArrayBuffer\",\n    value: function bindArrayBuffer(buffer) {\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n\n      this._bindBuffer(buffer, this._gl.ARRAY_BUFFER);\n    }\n    /**\n     * Bind a specific block at a given index in a specific shader program\n     * @param pipelineContext defines the pipeline context to use\n     * @param blockName defines the block name\n     * @param index defines the index where to bind the block\n     */\n\n  }, {\n    key: \"bindUniformBlock\",\n    value: function bindUniformBlock(pipelineContext, blockName, index) {\n      var program = pipelineContext.program;\n\n      var uniformLocation = this._gl.getUniformBlockIndex(program, blockName);\n\n      this._gl.uniformBlockBinding(program, uniformLocation, index);\n    } // eslint-disable-next-line @typescript-eslint/naming-convention\n\n  }, {\n    key: \"bindIndexBuffer\",\n    value: function bindIndexBuffer(buffer) {\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n\n      this._bindBuffer(buffer, this._gl.ELEMENT_ARRAY_BUFFER);\n    }\n  }, {\n    key: \"_bindBuffer\",\n    value: function _bindBuffer(buffer, target) {\n      if (this._vaoRecordInProgress || this._currentBoundBuffer[target] !== buffer) {\n        this._gl.bindBuffer(target, buffer ? buffer.underlyingResource : null);\n\n        this._currentBoundBuffer[target] = buffer;\n      }\n    }\n    /**\n     * update the bound buffer with the given data\n     * @param data defines the data to update\n     */\n\n  }, {\n    key: \"updateArrayBuffer\",\n    value: function updateArrayBuffer(data) {\n      this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n    }\n  }, {\n    key: \"_vertexAttribPointer\",\n    value: function _vertexAttribPointer(buffer, indx, size, type, normalized, stride, offset) {\n      var pointer = this._currentBufferPointers[indx];\n\n      if (!pointer) {\n        return;\n      }\n\n      var changed = false;\n\n      if (!pointer.active) {\n        changed = true;\n        pointer.active = true;\n        pointer.index = indx;\n        pointer.size = size;\n        pointer.type = type;\n        pointer.normalized = normalized;\n        pointer.stride = stride;\n        pointer.offset = offset;\n        pointer.buffer = buffer;\n      } else {\n        if (pointer.buffer !== buffer) {\n          pointer.buffer = buffer;\n          changed = true;\n        }\n\n        if (pointer.size !== size) {\n          pointer.size = size;\n          changed = true;\n        }\n\n        if (pointer.type !== type) {\n          pointer.type = type;\n          changed = true;\n        }\n\n        if (pointer.normalized !== normalized) {\n          pointer.normalized = normalized;\n          changed = true;\n        }\n\n        if (pointer.stride !== stride) {\n          pointer.stride = stride;\n          changed = true;\n        }\n\n        if (pointer.offset !== offset) {\n          pointer.offset = offset;\n          changed = true;\n        }\n      }\n\n      if (changed || this._vaoRecordInProgress) {\n        this.bindArrayBuffer(buffer);\n\n        if (type === this._gl.UNSIGNED_INT || type === this._gl.INT) {\n          this._gl.vertexAttribIPointer(indx, size, type, stride, offset);\n        } else {\n          this._gl.vertexAttribPointer(indx, size, type, normalized, stride, offset);\n        }\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_bindIndexBufferWithCache\",\n    value: function _bindIndexBufferWithCache(indexBuffer) {\n      if (indexBuffer == null) {\n        return;\n      }\n\n      if (this._cachedIndexBuffer !== indexBuffer) {\n        this._cachedIndexBuffer = indexBuffer;\n        this.bindIndexBuffer(indexBuffer);\n        this._uintIndicesCurrentlySet = indexBuffer.is32Bits;\n      }\n    }\n  }, {\n    key: \"_bindVertexBuffersAttributes\",\n    value: function _bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers) {\n      var attributes = effect.getAttributesNames();\n\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n\n      this.unbindAllAttributes();\n\n      for (var index = 0; index < attributes.length; index++) {\n        var order = effect.getAttributeLocation(index);\n\n        if (order >= 0) {\n          var ai = attributes[index];\n          var vertexBuffer = null;\n\n          if (overrideVertexBuffers) {\n            vertexBuffer = overrideVertexBuffers[ai];\n          }\n\n          if (!vertexBuffer) {\n            vertexBuffer = vertexBuffers[ai];\n          }\n\n          if (!vertexBuffer) {\n            continue;\n          }\n\n          this._gl.enableVertexAttribArray(order);\n\n          if (!this._vaoRecordInProgress) {\n            this._vertexAttribArraysEnabled[order] = true;\n          }\n\n          var buffer = vertexBuffer.getBuffer();\n\n          if (buffer) {\n            this._vertexAttribPointer(buffer, order, vertexBuffer.getSize(), vertexBuffer.type, vertexBuffer.normalized, vertexBuffer.byteStride, vertexBuffer.byteOffset);\n\n            if (vertexBuffer.getIsInstanced()) {\n              this._gl.vertexAttribDivisor(order, vertexBuffer.getInstanceDivisor());\n\n              if (!this._vaoRecordInProgress) {\n                this._currentInstanceLocations.push(order);\n\n                this._currentInstanceBuffers.push(buffer);\n              }\n            }\n          }\n        }\n      }\n    }\n    /**\n     * Records a vertex array object\n     * @see https://doc.babylonjs.com/features/webgl2#vertex-array-objects\n     * @param vertexBuffers defines the list of vertex buffers to store\n     * @param indexBuffer defines the index buffer to store\n     * @param effect defines the effect to store\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     * @returns the new vertex array object\n     */\n\n  }, {\n    key: \"recordVertexArrayObject\",\n    value: function recordVertexArrayObject(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n      var vao = this._gl.createVertexArray();\n\n      if (!vao) {\n        throw new Error(\"Unable to create VAO\");\n      }\n\n      this._vaoRecordInProgress = true;\n\n      this._gl.bindVertexArray(vao);\n\n      this._mustWipeVertexAttributes = true;\n\n      this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n\n      this.bindIndexBuffer(indexBuffer);\n      this._vaoRecordInProgress = false;\n\n      this._gl.bindVertexArray(null);\n\n      return vao;\n    }\n    /**\n     * Bind a specific vertex array object\n     * @see https://doc.babylonjs.com/features/webgl2#vertex-array-objects\n     * @param vertexArrayObject defines the vertex array object to bind\n     * @param indexBuffer defines the index buffer to bind\n     */\n\n  }, {\n    key: \"bindVertexArrayObject\",\n    value: function bindVertexArrayObject(vertexArrayObject, indexBuffer) {\n      if (this._cachedVertexArrayObject !== vertexArrayObject) {\n        this._cachedVertexArrayObject = vertexArrayObject;\n\n        this._gl.bindVertexArray(vertexArrayObject);\n\n        this._cachedVertexBuffers = null;\n        this._cachedIndexBuffer = null;\n        this._uintIndicesCurrentlySet = indexBuffer != null && indexBuffer.is32Bits;\n        this._mustWipeVertexAttributes = true;\n      }\n    }\n    /**\n     * Bind webGl buffers directly to the webGL context\n     * @param vertexBuffer defines the vertex buffer to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param vertexDeclaration defines the vertex declaration to use with the vertex buffer\n     * @param vertexStrideSize defines the vertex stride of the vertex buffer\n     * @param effect defines the effect associated with the vertex buffer\n     */\n\n  }, {\n    key: \"bindBuffersDirectly\",\n    value: function bindBuffersDirectly(vertexBuffer, indexBuffer, vertexDeclaration, vertexStrideSize, effect) {\n      if (this._cachedVertexBuffers !== vertexBuffer || this._cachedEffectForVertexBuffers !== effect) {\n        this._cachedVertexBuffers = vertexBuffer;\n        this._cachedEffectForVertexBuffers = effect;\n        var attributesCount = effect.getAttributesCount();\n\n        this._unbindVertexArrayObject();\n\n        this.unbindAllAttributes();\n        var offset = 0;\n\n        for (var index = 0; index < attributesCount; index++) {\n          if (index < vertexDeclaration.length) {\n            var order = effect.getAttributeLocation(index);\n\n            if (order >= 0) {\n              this._gl.enableVertexAttribArray(order);\n\n              this._vertexAttribArraysEnabled[order] = true;\n\n              this._vertexAttribPointer(vertexBuffer, order, vertexDeclaration[index], this._gl.FLOAT, false, vertexStrideSize, offset);\n            }\n\n            offset += vertexDeclaration[index] * 4;\n          }\n        }\n      }\n\n      this._bindIndexBufferWithCache(indexBuffer);\n    }\n  }, {\n    key: \"_unbindVertexArrayObject\",\n    value: function _unbindVertexArrayObject() {\n      if (!this._cachedVertexArrayObject) {\n        return;\n      }\n\n      this._cachedVertexArrayObject = null;\n\n      this._gl.bindVertexArray(null);\n    }\n    /**\n     * Bind a list of vertex buffers to the webGL context\n     * @param vertexBuffers defines the list of vertex buffers to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param effect defines the effect associated with the vertex buffers\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     */\n\n  }, {\n    key: \"bindBuffers\",\n    value: function bindBuffers(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n      if (this._cachedVertexBuffers !== vertexBuffers || this._cachedEffectForVertexBuffers !== effect) {\n        this._cachedVertexBuffers = vertexBuffers;\n        this._cachedEffectForVertexBuffers = effect;\n\n        this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n      }\n\n      this._bindIndexBufferWithCache(indexBuffer);\n    }\n    /**\n     * Unbind all instance attributes\n     */\n\n  }, {\n    key: \"unbindInstanceAttributes\",\n    value: function unbindInstanceAttributes() {\n      var boundBuffer;\n\n      for (var i = 0, ul = this._currentInstanceLocations.length; i < ul; i++) {\n        var instancesBuffer = this._currentInstanceBuffers[i];\n\n        if (boundBuffer != instancesBuffer && instancesBuffer.references) {\n          boundBuffer = instancesBuffer;\n          this.bindArrayBuffer(instancesBuffer);\n        }\n\n        var offsetLocation = this._currentInstanceLocations[i];\n\n        this._gl.vertexAttribDivisor(offsetLocation, 0);\n      }\n\n      this._currentInstanceBuffers.length = 0;\n      this._currentInstanceLocations.length = 0;\n    }\n    /**\n     * Release and free the memory of a vertex array object\n     * @param vao defines the vertex array object to delete\n     */\n\n  }, {\n    key: \"releaseVertexArrayObject\",\n    value: function releaseVertexArrayObject(vao) {\n      this._gl.deleteVertexArray(vao);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_releaseBuffer\",\n    value: function _releaseBuffer(buffer) {\n      buffer.references--;\n\n      if (buffer.references === 0) {\n        this._deleteBuffer(buffer);\n\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_deleteBuffer\",\n    value: function _deleteBuffer(buffer) {\n      this._gl.deleteBuffer(buffer.underlyingResource);\n    }\n    /**\n     * Update the content of a webGL buffer used with instantiation and bind it to the webGL context\n     * @param instancesBuffer defines the webGL buffer to update and bind\n     * @param data defines the data to store in the buffer\n     * @param offsetLocations defines the offsets or attributes information used to determine where data must be stored in the buffer\n     */\n\n  }, {\n    key: \"updateAndBindInstancesBuffer\",\n    value: function updateAndBindInstancesBuffer(instancesBuffer, data, offsetLocations) {\n      this.bindArrayBuffer(instancesBuffer);\n\n      if (data) {\n        this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n      }\n\n      if (offsetLocations[0].index !== undefined) {\n        this.bindInstancesBuffer(instancesBuffer, offsetLocations, true);\n      } else {\n        for (var index = 0; index < 4; index++) {\n          var offsetLocation = offsetLocations[index];\n\n          if (!this._vertexAttribArraysEnabled[offsetLocation]) {\n            this._gl.enableVertexAttribArray(offsetLocation);\n\n            this._vertexAttribArraysEnabled[offsetLocation] = true;\n          }\n\n          this._vertexAttribPointer(instancesBuffer, offsetLocation, 4, this._gl.FLOAT, false, 64, index * 16);\n\n          this._gl.vertexAttribDivisor(offsetLocation, 1);\n\n          this._currentInstanceLocations.push(offsetLocation);\n\n          this._currentInstanceBuffers.push(instancesBuffer);\n        }\n      }\n    }\n    /**\n     * Bind the content of a webGL buffer used with instantiation\n     * @param instancesBuffer defines the webGL buffer to bind\n     * @param attributesInfo defines the offsets or attributes information used to determine where data must be stored in the buffer\n     * @param computeStride defines Whether to compute the strides from the info or use the default 0\n     */\n\n  }, {\n    key: \"bindInstancesBuffer\",\n    value: function bindInstancesBuffer(instancesBuffer, attributesInfo) {\n      var computeStride = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      this.bindArrayBuffer(instancesBuffer);\n      var stride = 0;\n\n      if (computeStride) {\n        for (var i = 0; i < attributesInfo.length; i++) {\n          var ai = attributesInfo[i];\n          stride += ai.attributeSize * 4;\n        }\n      }\n\n      for (var _i = 0; _i < attributesInfo.length; _i++) {\n        var _ai = attributesInfo[_i];\n\n        if (_ai.index === undefined) {\n          _ai.index = this._currentEffect.getAttributeLocationByName(_ai.attributeName);\n        }\n\n        if (_ai.index < 0) {\n          continue;\n        }\n\n        if (!this._vertexAttribArraysEnabled[_ai.index]) {\n          this._gl.enableVertexAttribArray(_ai.index);\n\n          this._vertexAttribArraysEnabled[_ai.index] = true;\n        }\n\n        this._vertexAttribPointer(instancesBuffer, _ai.index, _ai.attributeSize, _ai.attributeType || this._gl.FLOAT, _ai.normalized || false, stride, _ai.offset);\n\n        this._gl.vertexAttribDivisor(_ai.index, _ai.divisor === undefined ? 1 : _ai.divisor);\n\n        this._currentInstanceLocations.push(_ai.index);\n\n        this._currentInstanceBuffers.push(instancesBuffer);\n      }\n    }\n    /**\n     * Disable the instance attribute corresponding to the name in parameter\n     * @param name defines the name of the attribute to disable\n     */\n\n  }, {\n    key: \"disableInstanceAttributeByName\",\n    value: function disableInstanceAttributeByName(name) {\n      if (!this._currentEffect) {\n        return;\n      }\n\n      var attributeLocation = this._currentEffect.getAttributeLocationByName(name);\n\n      this.disableInstanceAttribute(attributeLocation);\n    }\n    /**\n     * Disable the instance attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n\n  }, {\n    key: \"disableInstanceAttribute\",\n    value: function disableInstanceAttribute(attributeLocation) {\n      var shouldClean = false;\n      var index;\n\n      while ((index = this._currentInstanceLocations.indexOf(attributeLocation)) !== -1) {\n        this._currentInstanceLocations.splice(index, 1);\n\n        this._currentInstanceBuffers.splice(index, 1);\n\n        shouldClean = true;\n        index = this._currentInstanceLocations.indexOf(attributeLocation);\n      }\n\n      if (shouldClean) {\n        this._gl.vertexAttribDivisor(attributeLocation, 0);\n\n        this.disableAttributeByIndex(attributeLocation);\n      }\n    }\n    /**\n     * Disable the attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n\n  }, {\n    key: \"disableAttributeByIndex\",\n    value: function disableAttributeByIndex(attributeLocation) {\n      this._gl.disableVertexAttribArray(attributeLocation);\n\n      this._vertexAttribArraysEnabled[attributeLocation] = false;\n      this._currentBufferPointers[attributeLocation].active = false;\n    }\n    /**\n     * Send a draw order\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n\n  }, {\n    key: \"draw\",\n    value: function draw(useTriangles, indexStart, indexCount, instancesCount) {\n      this.drawElementsType(useTriangles ? 0 : 1, indexStart, indexCount, instancesCount);\n    }\n    /**\n     * Draw a list of points\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n\n  }, {\n    key: \"drawPointClouds\",\n    value: function drawPointClouds(verticesStart, verticesCount, instancesCount) {\n      this.drawArraysType(2, verticesStart, verticesCount, instancesCount);\n    }\n    /**\n     * Draw a list of unindexed primitives\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n\n  }, {\n    key: \"drawUnIndexed\",\n    value: function drawUnIndexed(useTriangles, verticesStart, verticesCount, instancesCount) {\n      this.drawArraysType(useTriangles ? 0 : 1, verticesStart, verticesCount, instancesCount);\n    }\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n\n  }, {\n    key: \"drawElementsType\",\n    value: function drawElementsType(fillMode, indexStart, indexCount, instancesCount) {\n      // Apply states\n      this.applyStates();\n\n      this._reportDrawCall(); // Render\n\n\n      var drawMode = this._drawMode(fillMode);\n\n      var indexFormat = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT;\n      var mult = this._uintIndicesCurrentlySet ? 4 : 2;\n\n      if (instancesCount) {\n        this._gl.drawElementsInstanced(drawMode, indexCount, indexFormat, indexStart * mult, instancesCount);\n      } else {\n        this._gl.drawElements(drawMode, indexCount, indexFormat, indexStart * mult);\n      }\n    }\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n\n  }, {\n    key: \"drawArraysType\",\n    value: function drawArraysType(fillMode, verticesStart, verticesCount, instancesCount) {\n      // Apply states\n      this.applyStates();\n\n      this._reportDrawCall();\n\n      var drawMode = this._drawMode(fillMode);\n\n      if (instancesCount) {\n        this._gl.drawArraysInstanced(drawMode, verticesStart, verticesCount, instancesCount);\n      } else {\n        this._gl.drawArrays(drawMode, verticesStart, verticesCount);\n      }\n    }\n  }, {\n    key: \"_drawMode\",\n    value: function _drawMode(fillMode) {\n      switch (fillMode) {\n        // Triangle views\n        case 0:\n          return this._gl.TRIANGLES;\n\n        case 2:\n          return this._gl.POINTS;\n\n        case 1:\n          return this._gl.LINES;\n        // Draw modes\n\n        case 3:\n          return this._gl.POINTS;\n\n        case 4:\n          return this._gl.LINES;\n\n        case 5:\n          return this._gl.LINE_LOOP;\n\n        case 6:\n          return this._gl.LINE_STRIP;\n\n        case 7:\n          return this._gl.TRIANGLE_STRIP;\n\n        case 8:\n          return this._gl.TRIANGLE_FAN;\n\n        default:\n          return this._gl.TRIANGLES;\n      }\n    }\n    /** @internal */\n\n  }, {\n    key: \"_reportDrawCall\",\n    value: function _reportDrawCall() {// Will be implemented by children\n    } // Shaders\n\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_releaseEffect\",\n    value: function _releaseEffect(effect) {\n      if (this._compiledEffects[effect._key]) {\n        delete this._compiledEffects[effect._key];\n        var pipelineContext = effect.getPipelineContext();\n\n        if (pipelineContext) {\n          this._deletePipelineContext(pipelineContext);\n        }\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_deletePipelineContext\",\n    value: function _deletePipelineContext(pipelineContext) {\n      var webGLPipelineContext = pipelineContext;\n\n      if (webGLPipelineContext && webGLPipelineContext.program) {\n        webGLPipelineContext.program.__SPECTOR_rebuildProgram = null;\n\n        this._gl.deleteProgram(webGLPipelineContext.program);\n      }\n    }\n    /** @internal */\n\n  }, {\n    key: \"_getGlobalDefines\",\n    value: function _getGlobalDefines(defines) {\n      if (defines) {\n        if (this.isNDCHalfZRange) {\n          defines[\"IS_NDC_HALF_ZRANGE\"] = \"\";\n        } else {\n          delete defines[\"IS_NDC_HALF_ZRANGE\"];\n        }\n\n        if (this.useReverseDepthBuffer) {\n          defines[\"USE_REVERSE_DEPTHBUFFER\"] = \"\";\n        } else {\n          delete defines[\"USE_REVERSE_DEPTHBUFFER\"];\n        }\n\n        if (this.useExactSrgbConversions) {\n          defines[\"USE_EXACT_SRGB_CONVERSIONS\"] = \"\";\n        } else {\n          delete defines[\"USE_EXACT_SRGB_CONVERSIONS\"];\n        }\n\n        return;\n      } else {\n        var s = \"\";\n\n        if (this.isNDCHalfZRange) {\n          s += \"#define IS_NDC_HALF_ZRANGE\";\n        }\n\n        if (this.useReverseDepthBuffer) {\n          if (s) {\n            s += \"\\n\";\n          }\n\n          s += \"#define USE_REVERSE_DEPTHBUFFER\";\n        }\n\n        if (this.useExactSrgbConversions) {\n          if (s) {\n            s += \"\\n\";\n          }\n\n          s += \"#define USE_EXACT_SRGB_CONVERSIONS\";\n        }\n\n        return s;\n      }\n    }\n    /**\n     * Create a new effect (used to store vertex/fragment shaders)\n     * @param baseName defines the base name of the effect (The name of file without .fragment.fx or .vertex.fx)\n     * @param attributesNamesOrOptions defines either a list of attribute names or an IEffectCreationOptions object\n     * @param uniformsNamesOrEngine defines either a list of uniform names or the engine to use\n     * @param samplers defines an array of string used to represent textures\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param fallbacks defines the list of potential fallbacks to use if shader compilation fails\n     * @param onCompiled defines a function to call when the effect creation is successful\n     * @param onError defines a function to call when the effect creation has failed\n     * @param indexParameters defines an object containing the index values to use to compile shaders (like the maximum number of simultaneous lights)\n     * @param shaderLanguage the language the shader is written in (default: GLSL)\n     * @returns the new Effect\n     */\n\n  }, {\n    key: \"createEffect\",\n    value: function createEffect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, defines, fallbacks, onCompiled, onError, indexParameters) {\n      var _ref3;\n\n      var shaderLanguage = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : ShaderLanguage.GLSL;\n      var vertex = baseName.vertexElement || baseName.vertex || baseName.vertexToken || baseName.vertexSource || baseName;\n      var fragment = baseName.fragmentElement || baseName.fragment || baseName.fragmentToken || baseName.fragmentSource || baseName;\n\n      var globalDefines = this._getGlobalDefines();\n\n      var fullDefines = (_ref3 = defines !== null && defines !== void 0 ? defines : attributesNamesOrOptions.defines) !== null && _ref3 !== void 0 ? _ref3 : \"\";\n\n      if (globalDefines) {\n        fullDefines += globalDefines;\n      }\n\n      var name = vertex + \"+\" + fragment + \"@\" + fullDefines;\n\n      if (this._compiledEffects[name]) {\n        var compiledEffect = this._compiledEffects[name];\n\n        if (onCompiled && compiledEffect.isReady()) {\n          onCompiled(compiledEffect);\n        }\n\n        return compiledEffect;\n      }\n\n      var effect = new Effect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, this, defines, fallbacks, onCompiled, onError, indexParameters, name, shaderLanguage);\n      this._compiledEffects[name] = effect;\n      return effect;\n    } // eslint-disable-next-line @typescript-eslint/naming-convention\n\n  }, {\n    key: \"_compileShader\",\n    value: function _compileShader(source, type, defines, shaderVersion) {\n      return this._compileRawShader(ThinEngine._ConcatenateShader(source, defines, shaderVersion), type);\n    }\n  }, {\n    key: \"_compileRawShader\",\n    value: function _compileRawShader(source, type) {\n      var gl = this._gl;\n      var shader = gl.createShader(type === \"vertex\" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);\n\n      if (!shader) {\n        var error = gl.NO_ERROR;\n        var tempError = gl.NO_ERROR;\n\n        while ((tempError = gl.getError()) !== gl.NO_ERROR) {\n          error = tempError;\n        }\n\n        throw new Error(\"Something went wrong while creating a gl \".concat(type, \" shader object. gl error=\").concat(error, \", gl isContextLost=\").concat(gl.isContextLost(), \", _contextWasLost=\").concat(this._contextWasLost));\n      }\n\n      gl.shaderSource(shader, source);\n      gl.compileShader(shader);\n      return shader;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getShaderSource\",\n    value: function _getShaderSource(shader) {\n      return this._gl.getShaderSource(shader);\n    }\n    /**\n     * Directly creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n\n  }, {\n    key: \"createRawShaderProgram\",\n    value: function createRawShaderProgram(pipelineContext, vertexCode, fragmentCode, context) {\n      var transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n      context = context || this._gl;\n\n      var vertexShader = this._compileRawShader(vertexCode, \"vertex\");\n\n      var fragmentShader = this._compileRawShader(fragmentCode, \"fragment\");\n\n      return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    }\n    /**\n     * Creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode  defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n\n  }, {\n    key: \"createShaderProgram\",\n    value: function createShaderProgram(pipelineContext, vertexCode, fragmentCode, defines, context) {\n      var transformFeedbackVaryings = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      context = context || this._gl;\n      var shaderVersion = this._webGLVersion > 1 ? \"#version 300 es\\n#define WEBGL2 \\n\" : \"\";\n\n      var vertexShader = this._compileShader(vertexCode, \"vertex\", defines, shaderVersion);\n\n      var fragmentShader = this._compileShader(fragmentCode, \"fragment\", defines, shaderVersion);\n\n      return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    }\n    /**\n     * Inline functions in shader code that are marked to be inlined\n     * @param code code to inline\n     * @returns inlined code\n     */\n\n  }, {\n    key: \"inlineShaderCode\",\n    value: function inlineShaderCode(code) {\n      // no inlining needed in the WebGL engine\n      return code;\n    }\n    /**\n     * Creates a new pipeline context\n     * @param shaderProcessingContext defines the shader processing context used during the processing if available\n     * @returns the new pipeline\n     */\n\n  }, {\n    key: \"createPipelineContext\",\n    value: function createPipelineContext(shaderProcessingContext) {\n      var pipelineContext = new WebGLPipelineContext();\n      pipelineContext.engine = this;\n\n      if (this._caps.parallelShaderCompile) {\n        pipelineContext.isParallelCompiled = true;\n      }\n\n      return pipelineContext;\n    }\n    /**\n     * Creates a new material context\n     * @returns the new context\n     */\n\n  }, {\n    key: \"createMaterialContext\",\n    value: function createMaterialContext() {\n      return undefined;\n    }\n    /**\n     * Creates a new draw context\n     * @returns the new context\n     */\n\n  }, {\n    key: \"createDrawContext\",\n    value: function createDrawContext() {\n      return undefined;\n    }\n  }, {\n    key: \"_createShaderProgram\",\n    value: function _createShaderProgram(pipelineContext, vertexShader, fragmentShader, context) {\n      var transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n      var shaderProgram = context.createProgram();\n      pipelineContext.program = shaderProgram;\n\n      if (!shaderProgram) {\n        throw new Error(\"Unable to create program\");\n      }\n\n      context.attachShader(shaderProgram, vertexShader);\n      context.attachShader(shaderProgram, fragmentShader);\n      context.linkProgram(shaderProgram);\n      pipelineContext.context = context;\n      pipelineContext.vertexShader = vertexShader;\n      pipelineContext.fragmentShader = fragmentShader;\n\n      if (!pipelineContext.isParallelCompiled) {\n        this._finalizePipelineContext(pipelineContext);\n      }\n\n      return shaderProgram;\n    }\n  }, {\n    key: \"_finalizePipelineContext\",\n    value: function _finalizePipelineContext(pipelineContext) {\n      var context = pipelineContext.context;\n      var vertexShader = pipelineContext.vertexShader;\n      var fragmentShader = pipelineContext.fragmentShader;\n      var program = pipelineContext.program;\n      var linked = context.getProgramParameter(program, context.LINK_STATUS);\n\n      if (!linked) {\n        // Get more info\n        // Vertex\n        if (!this._gl.getShaderParameter(vertexShader, this._gl.COMPILE_STATUS)) {\n          var log = this._gl.getShaderInfoLog(vertexShader);\n\n          if (log) {\n            pipelineContext.vertexCompilationError = log;\n            throw new Error(\"VERTEX SHADER \" + log);\n          }\n        } // Fragment\n\n\n        if (!this._gl.getShaderParameter(fragmentShader, this._gl.COMPILE_STATUS)) {\n          var _log = this._gl.getShaderInfoLog(fragmentShader);\n\n          if (_log) {\n            pipelineContext.fragmentCompilationError = _log;\n            throw new Error(\"FRAGMENT SHADER \" + _log);\n          }\n        }\n\n        var error = context.getProgramInfoLog(program);\n\n        if (error) {\n          pipelineContext.programLinkError = error;\n          throw new Error(error);\n        }\n      }\n\n      if (this.validateShaderPrograms) {\n        context.validateProgram(program);\n        var validated = context.getProgramParameter(program, context.VALIDATE_STATUS);\n\n        if (!validated) {\n          var _error = context.getProgramInfoLog(program);\n\n          if (_error) {\n            pipelineContext.programValidationError = _error;\n            throw new Error(_error);\n          }\n        }\n      }\n\n      context.deleteShader(vertexShader);\n      context.deleteShader(fragmentShader);\n      pipelineContext.vertexShader = undefined;\n      pipelineContext.fragmentShader = undefined;\n\n      if (pipelineContext.onCompiled) {\n        pipelineContext.onCompiled();\n        pipelineContext.onCompiled = undefined;\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_preparePipelineContext\",\n    value: function _preparePipelineContext(pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines, transformFeedbackVaryings, key) {\n      var webGLRenderingState = pipelineContext;\n\n      if (createAsRaw) {\n        webGLRenderingState.program = this.createRawShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, undefined, transformFeedbackVaryings);\n      } else {\n        webGLRenderingState.program = this.createShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, defines, undefined, transformFeedbackVaryings);\n      }\n\n      webGLRenderingState.program.__SPECTOR_rebuildProgram = rebuildRebind;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_isRenderingStateCompiled\",\n    value: function _isRenderingStateCompiled(pipelineContext) {\n      var webGLPipelineContext = pipelineContext;\n\n      if (this._gl.getProgramParameter(webGLPipelineContext.program, this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)) {\n        this._finalizePipelineContext(webGLPipelineContext);\n\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_executeWhenRenderingStateIsCompiled\",\n    value: function _executeWhenRenderingStateIsCompiled(pipelineContext, action) {\n      var webGLPipelineContext = pipelineContext;\n\n      if (!webGLPipelineContext.isParallelCompiled) {\n        action();\n        return;\n      }\n\n      var oldHandler = webGLPipelineContext.onCompiled;\n\n      if (oldHandler) {\n        webGLPipelineContext.onCompiled = function () {\n          oldHandler();\n          action();\n        };\n      } else {\n        webGLPipelineContext.onCompiled = action;\n      }\n    }\n    /**\n     * Gets the list of webGL uniform locations associated with a specific program based on a list of uniform names\n     * @param pipelineContext defines the pipeline context to use\n     * @param uniformsNames defines the list of uniform names\n     * @returns an array of webGL uniform locations\n     */\n\n  }, {\n    key: \"getUniforms\",\n    value: function getUniforms(pipelineContext, uniformsNames) {\n      var results = new Array();\n      var webGLPipelineContext = pipelineContext;\n\n      for (var index = 0; index < uniformsNames.length; index++) {\n        results.push(this._gl.getUniformLocation(webGLPipelineContext.program, uniformsNames[index]));\n      }\n\n      return results;\n    }\n    /**\n     * Gets the list of active attributes for a given webGL program\n     * @param pipelineContext defines the pipeline context to use\n     * @param attributesNames defines the list of attribute names to get\n     * @returns an array of indices indicating the offset of each attribute\n     */\n\n  }, {\n    key: \"getAttributes\",\n    value: function getAttributes(pipelineContext, attributesNames) {\n      var results = [];\n      var webGLPipelineContext = pipelineContext;\n\n      for (var index = 0; index < attributesNames.length; index++) {\n        try {\n          results.push(this._gl.getAttribLocation(webGLPipelineContext.program, attributesNames[index]));\n        } catch (e) {\n          results.push(-1);\n        }\n      }\n\n      return results;\n    }\n    /**\n     * Activates an effect, making it the current one (ie. the one used for rendering)\n     * @param effect defines the effect to activate\n     */\n\n  }, {\n    key: \"enableEffect\",\n    value: function enableEffect(effect) {\n      effect = effect !== null && DrawWrapper.IsWrapper(effect) ? effect.effect : effect; // get only the effect, we don't need a Wrapper in the WebGL engine\n\n      if (!effect || effect === this._currentEffect) {\n        return;\n      }\n\n      this._stencilStateComposer.stencilMaterial = undefined;\n      effect = effect; // Use program\n\n      this.bindSamplers(effect);\n      this._currentEffect = effect;\n\n      if (effect.onBind) {\n        effect.onBind(effect);\n      }\n\n      if (effect._onBindObservable) {\n        effect._onBindObservable.notifyObservers(effect);\n      }\n    }\n    /**\n     * Set the value of an uniform to a number (int)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the int number to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setInt\",\n    value: function setInt(uniform, value) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform1i(uniform, value);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setInt2\",\n    value: function setInt2(uniform, x, y) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform2i(uniform, x, y);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setInt3\",\n    value: function setInt3(uniform, x, y, z) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform3i(uniform, x, y, z);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setInt4\",\n    value: function setInt4(uniform, x, y, z, w) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform4i(uniform, x, y, z, w);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setIntArray\",\n    value: function setIntArray(uniform, array) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform1iv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setIntArray2\",\n    value: function setIntArray2(uniform, array) {\n      if (!uniform || array.length % 2 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform2iv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setIntArray3\",\n    value: function setIntArray3(uniform, array) {\n      if (!uniform || array.length % 3 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform3iv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setIntArray4\",\n    value: function setIntArray4(uniform, array) {\n      if (!uniform || array.length % 4 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform4iv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setArray\",\n    value: function setArray(uniform, array) {\n      if (!uniform) {\n        return false;\n      }\n\n      if (array.length < 1) {\n        return false;\n      }\n\n      this._gl.uniform1fv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setArray2\",\n    value: function setArray2(uniform, array) {\n      if (!uniform || array.length % 2 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform2fv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setArray3\",\n    value: function setArray3(uniform, array) {\n      if (!uniform || array.length % 3 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform3fv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setArray4\",\n    value: function setArray4(uniform, array) {\n      if (!uniform || array.length % 4 !== 0) {\n        return false;\n      }\n\n      this._gl.uniform4fv(uniform, array);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of float32 (stored as matrices)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrices defines the array of float32 to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setMatrices\",\n    value: function setMatrices(uniform, matrices) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniformMatrix4fv(uniform, false, matrices);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a matrix (3x3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 3x3 matrix to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setMatrix3x3\",\n    value: function setMatrix3x3(uniform, matrix) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniformMatrix3fv(uniform, false, matrix);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a matrix (2x2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 2x2 matrix to store\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setMatrix2x2\",\n    value: function setMatrix2x2(uniform, matrix) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniformMatrix2fv(uniform, false, matrix);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a number (float)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the float number to store\n     * @returns true if the value was transferred\n     */\n\n  }, {\n    key: \"setFloat\",\n    value: function setFloat(uniform, value) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform1f(uniform, value);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setFloat2\",\n    value: function setFloat2(uniform, x, y) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform2f(uniform, x, y);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setFloat3\",\n    value: function setFloat3(uniform, x, y, z) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform3f(uniform, x, y, z);\n\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n\n  }, {\n    key: \"setFloat4\",\n    value: function setFloat4(uniform, x, y, z, w) {\n      if (!uniform) {\n        return false;\n      }\n\n      this._gl.uniform4f(uniform, x, y, z, w);\n\n      return true;\n    } // States\n\n    /**\n     * Apply all cached states (depth, culling, stencil and alpha)\n     */\n\n  }, {\n    key: \"applyStates\",\n    value: function applyStates() {\n      this._depthCullingState.apply(this._gl);\n\n      this._stencilStateComposer.apply(this._gl);\n\n      this._alphaState.apply(this._gl);\n\n      if (this._colorWriteChanged) {\n        this._colorWriteChanged = false;\n        var enable = this._colorWrite;\n\n        this._gl.colorMask(enable, enable, enable, enable);\n      }\n    }\n    /**\n     * Enable or disable color writing\n     * @param enable defines the state to set\n     */\n\n  }, {\n    key: \"setColorWrite\",\n    value: function setColorWrite(enable) {\n      if (enable !== this._colorWrite) {\n        this._colorWriteChanged = true;\n        this._colorWrite = enable;\n      }\n    }\n    /**\n     * Gets a boolean indicating if color writing is enabled\n     * @returns the current color writing state\n     */\n\n  }, {\n    key: \"getColorWrite\",\n    value: function getColorWrite() {\n      return this._colorWrite;\n    }\n    /**\n     * Gets the depth culling state manager\n     */\n\n  }, {\n    key: \"depthCullingState\",\n    get: function get() {\n      return this._depthCullingState;\n    }\n    /**\n     * Gets the alpha state manager\n     */\n\n  }, {\n    key: \"alphaState\",\n    get: function get() {\n      return this._alphaState;\n    }\n    /**\n     * Gets the stencil state manager\n     */\n\n  }, {\n    key: \"stencilState\",\n    get: function get() {\n      return this._stencilState;\n    }\n    /**\n     * Gets the stencil state composer\n     */\n\n  }, {\n    key: \"stencilStateComposer\",\n    get: function get() {\n      return this._stencilStateComposer;\n    } // Textures\n\n    /**\n     * Clears the list of texture accessible through engine.\n     * This can help preventing texture load conflict due to name collision.\n     */\n\n  }, {\n    key: \"clearInternalTexturesCache\",\n    value: function clearInternalTexturesCache() {\n      this._internalTexturesCache.length = 0;\n    }\n    /**\n     * Force the entire cache to be cleared\n     * You should not have to use this function unless your engine needs to share the webGL context with another engine\n     * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n     */\n\n  }, {\n    key: \"wipeCaches\",\n    value: function wipeCaches(bruteForce) {\n      if (this.preventCacheWipeBetweenFrames && !bruteForce) {\n        return;\n      }\n\n      this._currentEffect = null;\n      this._viewportCached.x = 0;\n      this._viewportCached.y = 0;\n      this._viewportCached.z = 0;\n      this._viewportCached.w = 0; // Done before in case we clean the attributes\n\n      this._unbindVertexArrayObject();\n\n      if (bruteForce) {\n        this._currentProgram = null;\n        this.resetTextureCache();\n\n        this._stencilStateComposer.reset();\n\n        this._depthCullingState.reset();\n\n        this._depthCullingState.depthFunc = this._gl.LEQUAL;\n\n        this._alphaState.reset();\n\n        this._alphaMode = 1;\n        this._alphaEquation = 0;\n        this._colorWrite = true;\n        this._colorWriteChanged = true;\n        this._unpackFlipYCached = null;\n\n        this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n\n        this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\n\n        this._mustWipeVertexAttributes = true;\n        this.unbindAllAttributes();\n      }\n\n      this._resetVertexBufferBinding();\n\n      this._cachedIndexBuffer = null;\n      this._cachedEffectForVertexBuffers = null;\n      this.bindIndexBuffer(null);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getSamplingParameters\",\n    value: function _getSamplingParameters(samplingMode, generateMipMaps) {\n      var gl = this._gl;\n      var magFilter = gl.NEAREST;\n      var minFilter = gl.NEAREST;\n\n      switch (samplingMode) {\n        case 11:\n          magFilter = gl.LINEAR;\n\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n\n          break;\n\n        case 3:\n          magFilter = gl.LINEAR;\n\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n\n          break;\n\n        case 8:\n          magFilter = gl.NEAREST;\n\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n\n          break;\n\n        case 4:\n          magFilter = gl.NEAREST;\n\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n\n          break;\n\n        case 5:\n          magFilter = gl.NEAREST;\n\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n\n          break;\n\n        case 6:\n          magFilter = gl.NEAREST;\n\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n\n          break;\n\n        case 7:\n          magFilter = gl.NEAREST;\n          minFilter = gl.LINEAR;\n          break;\n\n        case 1:\n          magFilter = gl.NEAREST;\n          minFilter = gl.NEAREST;\n          break;\n\n        case 9:\n          magFilter = gl.LINEAR;\n\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n\n          break;\n\n        case 10:\n          magFilter = gl.LINEAR;\n\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n\n          break;\n\n        case 2:\n          magFilter = gl.LINEAR;\n          minFilter = gl.LINEAR;\n          break;\n\n        case 12:\n          magFilter = gl.LINEAR;\n          minFilter = gl.NEAREST;\n          break;\n      }\n\n      return {\n        min: minFilter,\n        mag: magFilter\n      };\n    }\n    /** @internal */\n\n  }, {\n    key: \"_createTexture\",\n    value: function _createTexture() {\n      var texture = this._gl.createTexture();\n\n      if (!texture) {\n        throw new Error(\"Unable to create texture\");\n      }\n\n      return texture;\n    }\n    /** @internal */\n\n  }, {\n    key: \"_createHardwareTexture\",\n    value: function _createHardwareTexture() {\n      return new WebGLHardwareTexture(this._createTexture(), this._gl);\n    }\n    /**\n     * Creates an internal texture without binding it to a framebuffer\n     * @internal\n     * @param size defines the size of the texture\n     * @param options defines the options used to create the texture\n     * @param delayGPUTextureCreation true to delay the texture creation the first time it is really needed. false to create it right away\n     * @param source source type of the texture\n     * @returns a new internal texture\n     */\n\n  }, {\n    key: \"_createInternalTexture\",\n    value: function _createInternalTexture(size, options) {\n      var delayGPUTextureCreation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var source = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : InternalTextureSource.Unknown;\n      var fullOptions = {};\n\n      if (options !== undefined && typeof options === \"object\") {\n        fullOptions.generateMipMaps = options.generateMipMaps;\n        fullOptions.type = options.type === undefined ? 0 : options.type;\n        fullOptions.samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n        fullOptions.format = options.format === undefined ? 5 : options.format;\n        fullOptions.useSRGBBuffer = options.useSRGBBuffer === undefined ? false : options.useSRGBBuffer;\n      } else {\n        fullOptions.generateMipMaps = options;\n        fullOptions.type = 0;\n        fullOptions.samplingMode = 3;\n        fullOptions.format = 5;\n        fullOptions.useSRGBBuffer = false;\n      }\n\n      fullOptions.useSRGBBuffer = fullOptions.useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU);\n\n      if (fullOptions.type === 1 && !this._caps.textureFloatLinearFiltering) {\n        // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n        fullOptions.samplingMode = 1;\n      } else if (fullOptions.type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n        // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n        fullOptions.samplingMode = 1;\n      }\n\n      if (fullOptions.type === 1 && !this._caps.textureFloat) {\n        fullOptions.type = 0;\n        Logger.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\");\n      }\n\n      var gl = this._gl;\n      var texture = new InternalTexture(this, source);\n      texture._useSRGBBuffer = !!fullOptions.useSRGBBuffer;\n      var width = size.width || size;\n      var height = size.height || size;\n      var layers = size.layers || 0;\n\n      var filters = this._getSamplingParameters(fullOptions.samplingMode, fullOptions.generateMipMaps ? true : false);\n\n      var target = layers !== 0 ? gl.TEXTURE_2D_ARRAY : gl.TEXTURE_2D;\n\n      var sizedFormat = this._getRGBABufferInternalSizedFormat(fullOptions.type, fullOptions.format, fullOptions.useSRGBBuffer);\n\n      var internalFormat = this._getInternalFormat(fullOptions.format);\n\n      var type = this._getWebGLTextureType(fullOptions.type); // Bind\n\n\n      this._bindTextureDirectly(target, texture);\n\n      if (layers !== 0) {\n        texture.is2DArray = true;\n        gl.texImage3D(target, 0, sizedFormat, width, height, layers, 0, internalFormat, type, null);\n      } else {\n        gl.texImage2D(target, 0, sizedFormat, width, height, 0, internalFormat, type, null);\n      }\n\n      gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, filters.mag);\n      gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, filters.min);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE); // MipMaps\n\n      if (fullOptions.generateMipMaps) {\n        this._gl.generateMipmap(target);\n      }\n\n      this._bindTextureDirectly(target, null);\n\n      texture.baseWidth = width;\n      texture.baseHeight = height;\n      texture.width = width;\n      texture.height = height;\n      texture.depth = layers;\n      texture.isReady = true;\n      texture.samples = 1;\n      texture.generateMipMaps = fullOptions.generateMipMaps ? true : false;\n      texture.samplingMode = fullOptions.samplingMode;\n      texture.type = fullOptions.type;\n      texture.format = fullOptions.format;\n\n      this._internalTexturesCache.push(texture);\n\n      return texture;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getUseSRGBBuffer\",\n    value: function _getUseSRGBBuffer(useSRGBBuffer, noMipmap) {\n      // Generating mipmaps for sRGB textures is not supported in WebGL1 so we must disable the support if mipmaps is enabled\n      return useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU || noMipmap);\n    }\n  }, {\n    key: \"_createTextureBase\",\n    value: function _createTextureBase(url, noMipmap, invertY, scene) {\n      var _this3 = this;\n\n      var samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n      var onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      var onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n      var prepareTexture = arguments.length > 7 ? arguments[7] : undefined;\n      var prepareTextureProcessFunction = arguments.length > 8 ? arguments[8] : undefined;\n      var buffer = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n      var fallback = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n      var format = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : null;\n      var forcedExtension = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : null;\n      var mimeType = arguments.length > 13 ? arguments[13] : undefined;\n      var loaderOptions = arguments.length > 14 ? arguments[14] : undefined;\n      var useSRGBBuffer = arguments.length > 15 ? arguments[15] : undefined;\n      url = url || \"\";\n      var fromData = url.substr(0, 5) === \"data:\";\n      var fromBlob = url.substr(0, 5) === \"blob:\";\n      var isBase64 = fromData && url.indexOf(\";base64,\") !== -1;\n      var texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Url);\n      var originalUrl = url;\n\n      if (this._transformTextureUrl && !isBase64 && !fallback && !buffer) {\n        url = this._transformTextureUrl(url);\n      }\n\n      if (originalUrl !== url) {\n        texture._originalUrl = originalUrl;\n      } // establish the file extension, if possible\n\n\n      var lastDot = url.lastIndexOf(\".\");\n      var extension = forcedExtension ? forcedExtension : lastDot > -1 ? url.substring(lastDot).toLowerCase() : \"\";\n      var loader = null; // Remove query string\n\n      var queryStringIndex = extension.indexOf(\"?\");\n\n      if (queryStringIndex > -1) {\n        extension = extension.split(\"?\")[0];\n      }\n\n      var _iterator7 = _createForOfIteratorHelper(ThinEngine._TextureLoaders),\n          _step7;\n\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var availableLoader = _step7.value;\n\n          if (availableLoader.canLoad(extension, mimeType)) {\n            loader = availableLoader;\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n\n      if (scene) {\n        scene.addPendingData(texture);\n      }\n\n      texture.url = url;\n      texture.generateMipMaps = !noMipmap;\n      texture.samplingMode = samplingMode;\n      texture.invertY = invertY;\n      texture._useSRGBBuffer = this._getUseSRGBBuffer(!!useSRGBBuffer, noMipmap);\n\n      if (!this._doNotHandleContextLost) {\n        // Keep a link to the buffer only if we plan to handle context lost\n        texture._buffer = buffer;\n      }\n\n      var onLoadObserver = null;\n\n      if (onLoad && !fallback) {\n        onLoadObserver = texture.onLoadedObservable.add(onLoad);\n      }\n\n      if (!fallback) {\n        this._internalTexturesCache.push(texture);\n      }\n\n      var onInternalError = function onInternalError(message, exception) {\n        if (scene) {\n          scene.removePendingData(texture);\n        }\n\n        if (url === originalUrl) {\n          if (onLoadObserver) {\n            texture.onLoadedObservable.remove(onLoadObserver);\n          }\n\n          if (EngineStore.UseFallbackTexture) {\n            _this3._createTextureBase(EngineStore.FallbackTexture, noMipmap, texture.invertY, scene, samplingMode, null, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture);\n          }\n\n          message = (message || \"Unknown error\") + (EngineStore.UseFallbackTexture ? \" - Fallback texture was used\" : \"\");\n          texture.onErrorObservable.notifyObservers({\n            message: message,\n            exception: exception\n          });\n\n          if (onError) {\n            onError(message, exception);\n          }\n        } else {\n          // fall back to the original url if the transformed url fails to load\n          Logger.Warn(\"Failed to load \".concat(url, \", falling back to \").concat(originalUrl));\n\n          _this3._createTextureBase(originalUrl, noMipmap, texture.invertY, scene, samplingMode, onLoad, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n        }\n      }; // processing for non-image formats\n\n\n      if (loader) {\n        var callback = function callback(data) {\n          loader.loadData(data, texture, function (width, height, loadMipmap, isCompressed, done, loadFailed) {\n            if (loadFailed) {\n              onInternalError(\"TextureLoader failed to load data\");\n            } else {\n              prepareTexture(texture, extension, scene, {\n                width: width,\n                height: height\n              }, texture.invertY, !loadMipmap, isCompressed, function () {\n                done();\n                return false;\n              }, samplingMode);\n            }\n          }, loaderOptions);\n        };\n\n        if (!buffer) {\n          this._loadFile(url, function (data) {\n            return callback(new Uint8Array(data));\n          }, undefined, scene ? scene.offlineProvider : undefined, true, function (request, exception) {\n            onInternalError(\"Unable to load \" + (request ? request.responseURL : url, exception));\n          });\n        } else {\n          if (buffer instanceof ArrayBuffer) {\n            callback(new Uint8Array(buffer));\n          } else if (ArrayBuffer.isView(buffer)) {\n            callback(buffer);\n          } else {\n            if (onError) {\n              onError(\"Unable to load: only ArrayBuffer or ArrayBufferView is supported\", null);\n            }\n          }\n        }\n      } else {\n        var onload = function onload(img) {\n          if (fromBlob && !_this3._doNotHandleContextLost) {\n            // We need to store the image if we need to rebuild the texture\n            // in case of a webgl context lost\n            texture._buffer = img;\n          }\n\n          prepareTexture(texture, extension, scene, img, texture.invertY, noMipmap, false, prepareTextureProcessFunction, samplingMode);\n        }; // According to the WebGL spec section 6.10, ImageBitmaps must be inverted on creation.\n        // So, we pass imageOrientation to _FileToolsLoadImage() as it may create an ImageBitmap.\n\n\n        if (!fromData || isBase64) {\n          if (buffer && (typeof buffer.decoding === \"string\" || buffer.close)) {\n            onload(buffer);\n          } else {\n            ThinEngine._FileToolsLoadImage(url, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n              imageOrientation: \"flipY\"\n            } : undefined);\n          }\n        } else if (typeof buffer === \"string\" || buffer instanceof ArrayBuffer || ArrayBuffer.isView(buffer) || buffer instanceof Blob) {\n          ThinEngine._FileToolsLoadImage(buffer, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n            imageOrientation: \"flipY\"\n          } : undefined);\n        } else if (buffer) {\n          onload(buffer);\n        }\n      }\n\n      return texture;\n    }\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a WebGLTexture\n     * @param url defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @param loaderOptions options to be passed to the loader\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n\n  }, {\n    key: \"createTexture\",\n    value: function createTexture(url, noMipmap, invertY, scene) {\n      var _this4 = this;\n\n      var samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n      var onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      var onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n      var buffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      var fallback = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var format = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n      var forcedExtension = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n      var mimeType = arguments.length > 11 ? arguments[11] : undefined;\n      var loaderOptions = arguments.length > 12 ? arguments[12] : undefined;\n      var creationFlags = arguments.length > 13 ? arguments[13] : undefined;\n      var useSRGBBuffer = arguments.length > 14 ? arguments[14] : undefined;\n      return this._createTextureBase(url, noMipmap, invertY, scene, samplingMode, onLoad, onError, this._prepareWebGLTexture.bind(this), function (potWidth, potHeight, img, extension, texture, continuationCallback) {\n        var gl = _this4._gl;\n        var isPot = img.width === potWidth && img.height === potHeight;\n        var internalFormat = format ? _this4._getInternalFormat(format, texture._useSRGBBuffer) : extension === \".jpg\" && !texture._useSRGBBuffer ? gl.RGB : texture._useSRGBBuffer ? gl.SRGB8_ALPHA8 : gl.RGBA;\n        var texelFormat = format ? _this4._getInternalFormat(format) : extension === \".jpg\" && !texture._useSRGBBuffer ? gl.RGB : gl.RGBA;\n\n        if (texture._useSRGBBuffer && _this4.webGLVersion === 1) {\n          texelFormat = internalFormat;\n        }\n\n        if (isPot) {\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n          return false;\n        }\n\n        var maxTextureSize = _this4._caps.maxTextureSize;\n\n        if (img.width > maxTextureSize || img.height > maxTextureSize || !_this4._supportsHardwareTextureRescaling) {\n          _this4._prepareWorkingCanvas();\n\n          if (!_this4._workingCanvas || !_this4._workingContext) {\n            return false;\n          }\n\n          _this4._workingCanvas.width = potWidth;\n          _this4._workingCanvas.height = potHeight;\n\n          _this4._workingContext.drawImage(img, 0, 0, img.width, img.height, 0, 0, potWidth, potHeight);\n\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, _this4._workingCanvas);\n          texture.width = potWidth;\n          texture.height = potHeight;\n          return false;\n        } else {\n          // Using shaders when possible to rescale because canvas.drawImage is lossy\n          var source = new InternalTexture(_this4, InternalTextureSource.Temp);\n\n          _this4._bindTextureDirectly(gl.TEXTURE_2D, source, true);\n\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n\n          _this4._rescaleTexture(source, texture, scene, internalFormat, function () {\n            _this4._releaseTexture(source);\n\n            _this4._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n\n            continuationCallback();\n          });\n        }\n\n        return true;\n      }, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n    }\n    /**\n     * Loads an image as an HTMLImageElement.\n     * @param input url string, ArrayBuffer, or Blob to load\n     * @param onLoad callback called when the image successfully loads\n     * @param onError callback called when the image fails to load\n     * @param offlineProvider offline provider for caching\n     * @param mimeType optional mime type\n     * @param imageBitmapOptions optional the options to use when creating an ImageBitmap\n     * @returns the HTMLImageElement of the loaded image\n     * @internal\n     */\n\n  }, {\n    key: \"_rescaleTexture\",\n    value:\n    /**\n     * @internal\n     */\n    function _rescaleTexture(source, destination, scene, internalFormat, onComplete) {}\n    /**\n     * Creates a raw texture\n     * @param data defines the data to store in the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param format defines the format of the data\n     * @param generateMipMaps defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\n     * @param compression defines the compression used (null by default)\n     * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns the raw texture inside an InternalTexture\n     */\n\n  }, {\n    key: \"createRawTexture\",\n    value: function createRawTexture(data, width, height, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      var type = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;\n      var creationFlags = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      var useSRGBBuffer = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : false;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw cube texture\n     * @param data defines the array of data to use to create each face\n     * @param size defines the size of the textures\n     * @param format defines the format of the data\n     * @param type defines the type of the data (like Engine.TEXTURETYPE_UNSIGNED_INT)\n     * @param generateMipMaps  defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compression used (null by default)\n     * @returns the cube texture as an InternalTexture\n     */\n\n  }, {\n    key: \"createRawCubeTexture\",\n    value: function createRawCubeTexture(data, size, format, type, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw 3D texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the depth of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 3D texture (stored in an InternalTexture)\n     */\n\n  }, {\n    key: \"createRawTexture3D\",\n    value: function createRawTexture3D(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw 2D array texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the number of layers of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 2D array texture (stored in an InternalTexture)\n     */\n\n  }, {\n    key: \"createRawTexture2DArray\",\n    value: function createRawTexture2DArray(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_unpackFlipY\",\n    value: function _unpackFlipY(value) {\n      if (this._unpackFlipYCached !== value) {\n        this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, value ? 1 : 0);\n\n        if (this.enableUnpackFlipYCached) {\n          this._unpackFlipYCached = value;\n        }\n      }\n    }\n    /** @internal */\n\n  }, {\n    key: \"_getUnpackAlignement\",\n    value: function _getUnpackAlignement() {\n      return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT);\n    }\n  }, {\n    key: \"_getTextureTarget\",\n    value: function _getTextureTarget(texture) {\n      if (texture.isCube) {\n        return this._gl.TEXTURE_CUBE_MAP;\n      } else if (texture.is3D) {\n        return this._gl.TEXTURE_3D;\n      } else if (texture.is2DArray || texture.isMultiview) {\n        return this._gl.TEXTURE_2D_ARRAY;\n      }\n\n      return this._gl.TEXTURE_2D;\n    }\n    /**\n     * Update the sampling mode of a given texture\n     * @param samplingMode defines the required sampling mode\n     * @param texture defines the texture to update\n     * @param generateMipMaps defines whether to generate mipmaps for the texture\n     */\n\n  }, {\n    key: \"updateTextureSamplingMode\",\n    value: function updateTextureSamplingMode(samplingMode, texture) {\n      var generateMipMaps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var target = this._getTextureTarget(texture);\n\n      var filters = this._getSamplingParameters(samplingMode, texture.generateMipMaps || generateMipMaps);\n\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_MAG_FILTER, filters.mag, texture);\n\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_MIN_FILTER, filters.min);\n\n      if (generateMipMaps) {\n        texture.generateMipMaps = true;\n\n        this._gl.generateMipmap(target);\n      }\n\n      this._bindTextureDirectly(target, null);\n\n      texture.samplingMode = samplingMode;\n    }\n    /**\n     * Update the dimensions of a texture\n     * @param texture texture to update\n     * @param width new width of the texture\n     * @param height new height of the texture\n     * @param depth new depth of the texture\n     */\n\n  }, {\n    key: \"updateTextureDimensions\",\n    value: function updateTextureDimensions(texture, width, height) {\n      var depth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    }\n    /**\n     * Update the sampling mode of a given texture\n     * @param texture defines the texture to update\n     * @param wrapU defines the texture wrap mode of the u coordinates\n     * @param wrapV defines the texture wrap mode of the v coordinates\n     * @param wrapR defines the texture wrap mode of the r coordinates\n     */\n\n  }, {\n    key: \"updateTextureWrappingMode\",\n    value: function updateTextureWrappingMode(texture, wrapU) {\n      var wrapV = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var wrapR = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      var target = this._getTextureTarget(texture);\n\n      if (wrapU !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(wrapU), texture);\n\n        texture._cachedWrapU = wrapU;\n      }\n\n      if (wrapV !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(wrapV), texture);\n\n        texture._cachedWrapV = wrapV;\n      }\n\n      if ((texture.is2DArray || texture.is3D) && wrapR !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(wrapR), texture);\n\n        texture._cachedWrapR = wrapR;\n      }\n\n      this._bindTextureDirectly(target, null);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_setupDepthStencilTexture\",\n    value: function _setupDepthStencilTexture(internalTexture, size, generateStencil, bilinearFiltering, comparisonFunction) {\n      var samples = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1;\n      var width = size.width || size;\n      var height = size.height || size;\n      var layers = size.layers || 0;\n      internalTexture.baseWidth = width;\n      internalTexture.baseHeight = height;\n      internalTexture.width = width;\n      internalTexture.height = height;\n      internalTexture.is2DArray = layers > 0;\n      internalTexture.depth = layers;\n      internalTexture.isReady = true;\n      internalTexture.samples = samples;\n      internalTexture.generateMipMaps = false;\n      internalTexture.samplingMode = bilinearFiltering ? 2 : 1;\n      internalTexture.type = 0;\n      internalTexture._comparisonFunction = comparisonFunction;\n      var gl = this._gl;\n\n      var target = this._getTextureTarget(internalTexture);\n\n      var samplingParameters = this._getSamplingParameters(internalTexture.samplingMode, false);\n\n      gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, samplingParameters.mag);\n      gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, samplingParameters.min);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE); // TEXTURE_COMPARE_FUNC/MODE are only availble in WebGL2.\n\n      if (this.webGLVersion > 1) {\n        if (comparisonFunction === 0) {\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, 515);\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.NONE);\n        } else {\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, comparisonFunction);\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\n        }\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_uploadCompressedDataToTextureDirectly\",\n    value: function _uploadCompressedDataToTextureDirectly(texture, internalFormat, width, height, data) {\n      var faceIndex = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n      var lod = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var gl = this._gl;\n      var target = gl.TEXTURE_2D;\n\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      }\n\n      if (texture._useSRGBBuffer) {\n        switch (internalFormat) {\n          case 37492:\n          case 36196:\n            // Note, if using ETC1 and sRGB is requested, this will use ETC2 if available.\n            if (this._caps.etc2) {\n              internalFormat = gl.COMPRESSED_SRGB8_ETC2;\n            } else {\n              texture._useSRGBBuffer = false;\n            }\n\n            break;\n\n          case 37496:\n            if (this._caps.etc2) {\n              internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n            } else {\n              texture._useSRGBBuffer = false;\n            }\n\n            break;\n\n          case 36492:\n            internalFormat = gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n            break;\n\n          case 37808:\n            internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n            break;\n\n          case 33776:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n\n            break;\n\n          case 33777:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n\n            break;\n\n          case 33779:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n\n            break;\n\n          default:\n            // We don't support a sRGB format corresponding to internalFormat, so revert to non sRGB format\n            texture._useSRGBBuffer = false;\n            break;\n        }\n      }\n\n      this._gl.compressedTexImage2D(target, lod, internalFormat, width, height, 0, data);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_uploadDataToTextureDirectly\",\n    value: function _uploadDataToTextureDirectly(texture, imageData) {\n      var faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var babylonInternalFormat = arguments.length > 4 ? arguments[4] : undefined;\n      var useTextureWidthAndHeight = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n      var gl = this._gl;\n\n      var textureType = this._getWebGLTextureType(texture.type);\n\n      var format = this._getInternalFormat(texture.format);\n\n      var internalFormat = babylonInternalFormat === undefined ? this._getRGBABufferInternalSizedFormat(texture.type, texture.format, texture._useSRGBBuffer) : this._getInternalFormat(babylonInternalFormat, texture._useSRGBBuffer);\n\n      this._unpackFlipY(texture.invertY);\n\n      var target = gl.TEXTURE_2D;\n\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      }\n\n      var lodMaxWidth = Math.round(Math.log(texture.width) * Math.LOG2E);\n      var lodMaxHeight = Math.round(Math.log(texture.height) * Math.LOG2E);\n      var width = useTextureWidthAndHeight ? texture.width : Math.pow(2, Math.max(lodMaxWidth - lod, 0));\n      var height = useTextureWidthAndHeight ? texture.height : Math.pow(2, Math.max(lodMaxHeight - lod, 0));\n      gl.texImage2D(target, lod, internalFormat, width, height, 0, format, textureType, imageData);\n    }\n    /**\n     * Update a portion of an internal texture\n     * @param texture defines the texture to update\n     * @param imageData defines the data to store into the texture\n     * @param xOffset defines the x coordinates of the update rectangle\n     * @param yOffset defines the y coordinates of the update rectangle\n     * @param width defines the width of the update rectangle\n     * @param height defines the height of the update rectangle\n     * @param faceIndex defines the face index if texture is a cube (0 by default)\n     * @param lod defines the lod level to update (0 by default)\n     * @param generateMipMaps defines whether to generate mipmaps or not\n     */\n\n  }, {\n    key: \"updateTextureData\",\n    value: function updateTextureData(texture, imageData, xOffset, yOffset, width, height) {\n      var faceIndex = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var lod = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;\n      var generateMipMaps = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : false;\n      var gl = this._gl;\n\n      var textureType = this._getWebGLTextureType(texture.type);\n\n      var format = this._getInternalFormat(texture.format);\n\n      this._unpackFlipY(texture.invertY);\n\n      var target = gl.TEXTURE_2D;\n\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      }\n\n      this._bindTextureDirectly(target, texture, true);\n\n      gl.texSubImage2D(target, lod, xOffset, yOffset, width, height, format, textureType, imageData);\n\n      if (generateMipMaps) {\n        this._gl.generateMipmap(target);\n      }\n\n      this._bindTextureDirectly(target, null);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_uploadArrayBufferViewToTexture\",\n    value: function _uploadArrayBufferViewToTexture(texture, imageData) {\n      var faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var gl = this._gl;\n      var bindTarget = texture.isCube ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;\n\n      this._bindTextureDirectly(bindTarget, texture, true);\n\n      this._uploadDataToTextureDirectly(texture, imageData, faceIndex, lod);\n\n      this._bindTextureDirectly(bindTarget, null, true);\n    }\n  }, {\n    key: \"_prepareWebGLTextureContinuation\",\n    value: function _prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode) {\n      var gl = this._gl;\n\n      if (!gl) {\n        return;\n      }\n\n      var filters = this._getSamplingParameters(samplingMode, !noMipmap);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filters.mag);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filters.min);\n\n      if (!noMipmap && !isCompressed) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      this._bindTextureDirectly(gl.TEXTURE_2D, null); // this.resetTextureCache();\n\n\n      if (scene) {\n        scene.removePendingData(texture);\n      }\n\n      texture.onLoadedObservable.notifyObservers(texture);\n      texture.onLoadedObservable.clear();\n    }\n  }, {\n    key: \"_prepareWebGLTexture\",\n    value: function _prepareWebGLTexture(texture, extension, scene, img, invertY, noMipmap, isCompressed, processFunction) {\n      var _this5 = this;\n\n      var samplingMode = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 3;\n      var maxTextureSize = this.getCaps().maxTextureSize;\n      var potWidth = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.width, maxTextureSize) : img.width);\n      var potHeight = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.height, maxTextureSize) : img.height);\n      var gl = this._gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (!texture._hardwareTexture) {\n        //  this.resetTextureCache();\n        if (scene) {\n          scene.removePendingData(texture);\n        }\n\n        return;\n      }\n\n      this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n\n      this._unpackFlipY(invertY === undefined ? true : invertY ? true : false);\n\n      texture.baseWidth = img.width;\n      texture.baseHeight = img.height;\n      texture.width = potWidth;\n      texture.height = potHeight;\n      texture.isReady = true;\n\n      if (processFunction(potWidth, potHeight, img, extension, texture, function () {\n        _this5._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n      })) {\n        // Returning as texture needs extra async steps\n        return;\n      }\n\n      this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_setupFramebufferDepthAttachments\",\n    value: function _setupFramebufferDepthAttachments(generateStencilBuffer, generateDepthBuffer, width, height) {\n      var samples = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n      var gl = this._gl; // Create the depth/stencil buffer\n\n      if (generateStencilBuffer && generateDepthBuffer) {\n        return this._createRenderBuffer(width, height, samples, gl.DEPTH_STENCIL, gl.DEPTH24_STENCIL8, gl.DEPTH_STENCIL_ATTACHMENT);\n      }\n\n      if (generateDepthBuffer) {\n        var depthFormat = gl.DEPTH_COMPONENT16;\n\n        if (this._webGLVersion > 1) {\n          depthFormat = gl.DEPTH_COMPONENT32F;\n        }\n\n        return this._createRenderBuffer(width, height, samples, depthFormat, depthFormat, gl.DEPTH_ATTACHMENT);\n      }\n\n      if (generateStencilBuffer) {\n        return this._createRenderBuffer(width, height, samples, gl.STENCIL_INDEX8, gl.STENCIL_INDEX8, gl.STENCIL_ATTACHMENT);\n      }\n\n      return null;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_createRenderBuffer\",\n    value: function _createRenderBuffer(width, height, samples, internalFormat, msInternalFormat, attachment) {\n      var unbindBuffer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n      var gl = this._gl;\n      var renderBuffer = gl.createRenderbuffer();\n      return this._updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment, unbindBuffer);\n    }\n  }, {\n    key: \"_updateRenderBuffer\",\n    value: function _updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment) {\n      var unbindBuffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : true;\n      var gl = this._gl;\n      gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n\n      if (samples > 1 && gl.renderbufferStorageMultisample) {\n        gl.renderbufferStorageMultisample(gl.RENDERBUFFER, samples, msInternalFormat, width, height);\n      } else {\n        gl.renderbufferStorage(gl.RENDERBUFFER, internalFormat, width, height);\n      }\n\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, renderBuffer);\n\n      if (unbindBuffer) {\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n      }\n\n      return renderBuffer;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_releaseTexture\",\n    value: function _releaseTexture(texture) {\n      var _texture$_hardwareTex;\n\n      this._deleteTexture((_texture$_hardwareTex = texture._hardwareTexture) === null || _texture$_hardwareTex === void 0 ? void 0 : _texture$_hardwareTex.underlyingResource); // Unbind channels\n\n\n      this.unbindAllTextures();\n\n      var index = this._internalTexturesCache.indexOf(texture);\n\n      if (index !== -1) {\n        this._internalTexturesCache.splice(index, 1);\n      } // Integrated fixed lod samplers.\n\n\n      if (texture._lodTextureHigh) {\n        texture._lodTextureHigh.dispose();\n      }\n\n      if (texture._lodTextureMid) {\n        texture._lodTextureMid.dispose();\n      }\n\n      if (texture._lodTextureLow) {\n        texture._lodTextureLow.dispose();\n      } // Integrated irradiance map.\n\n\n      if (texture._irradianceTexture) {\n        texture._irradianceTexture.dispose();\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_releaseRenderTargetWrapper\",\n    value: function _releaseRenderTargetWrapper(rtWrapper) {\n      var index = this._renderTargetWrapperCache.indexOf(rtWrapper);\n\n      if (index !== -1) {\n        this._renderTargetWrapperCache.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"_deleteTexture\",\n    value: function _deleteTexture(texture) {\n      if (texture) {\n        this._gl.deleteTexture(texture);\n      }\n    }\n  }, {\n    key: \"_setProgram\",\n    value: function _setProgram(program) {\n      if (this._currentProgram !== program) {\n        this._gl.useProgram(program);\n\n        this._currentProgram = program;\n      }\n    }\n    /**\n     * Binds an effect to the webGL context\n     * @param effect defines the effect to bind\n     */\n\n  }, {\n    key: \"bindSamplers\",\n    value: function bindSamplers(effect) {\n      var webGLPipelineContext = effect.getPipelineContext();\n\n      this._setProgram(webGLPipelineContext.program);\n\n      var samplers = effect.getSamplers();\n\n      for (var index = 0; index < samplers.length; index++) {\n        var uniform = effect.getUniform(samplers[index]);\n\n        if (uniform) {\n          this._boundUniforms[index] = uniform;\n        }\n      }\n\n      this._currentEffect = null;\n    }\n  }, {\n    key: \"_activateCurrentTexture\",\n    value: function _activateCurrentTexture() {\n      if (this._currentTextureChannel !== this._activeChannel) {\n        this._gl.activeTexture(this._gl.TEXTURE0 + this._activeChannel);\n\n        this._currentTextureChannel = this._activeChannel;\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_bindTextureDirectly\",\n    value: function _bindTextureDirectly(target, texture) {\n      var forTextureDataUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var force = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var wasPreviouslyBound = false;\n      var isTextureForRendering = texture && texture._associatedChannel > -1;\n\n      if (forTextureDataUpdate && isTextureForRendering) {\n        this._activeChannel = texture._associatedChannel;\n      }\n\n      var currentTextureBound = this._boundTexturesCache[this._activeChannel];\n\n      if (currentTextureBound !== texture || force) {\n        this._activateCurrentTexture();\n\n        if (texture && texture.isMultiview) {\n          //this._gl.bindTexture(target, texture ? texture._colorTextureArray : null);\n          console.error(target, texture);\n          throw \"_bindTextureDirectly called with a multiview texture!\";\n        } else {\n          var _texture$_hardwareTex2, _texture$_hardwareTex3;\n\n          this._gl.bindTexture(target, (_texture$_hardwareTex2 = texture === null || texture === void 0 ? void 0 : (_texture$_hardwareTex3 = texture._hardwareTexture) === null || _texture$_hardwareTex3 === void 0 ? void 0 : _texture$_hardwareTex3.underlyingResource) !== null && _texture$_hardwareTex2 !== void 0 ? _texture$_hardwareTex2 : null);\n        }\n\n        this._boundTexturesCache[this._activeChannel] = texture;\n\n        if (texture) {\n          texture._associatedChannel = this._activeChannel;\n        }\n      } else if (forTextureDataUpdate) {\n        wasPreviouslyBound = true;\n\n        this._activateCurrentTexture();\n      }\n\n      if (isTextureForRendering && !forTextureDataUpdate) {\n        this._bindSamplerUniformToChannel(texture._associatedChannel, this._activeChannel);\n      }\n\n      return wasPreviouslyBound;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_bindTexture\",\n    value: function _bindTexture(channel, texture, name) {\n      if (channel === undefined) {\n        return;\n      }\n\n      if (texture) {\n        texture._associatedChannel = channel;\n      }\n\n      this._activeChannel = channel;\n      var target = texture ? this._getTextureTarget(texture) : this._gl.TEXTURE_2D;\n\n      this._bindTextureDirectly(target, texture);\n    }\n    /**\n     * Unbind all textures from the webGL context\n     */\n\n  }, {\n    key: \"unbindAllTextures\",\n    value: function unbindAllTextures() {\n      for (var channel = 0; channel < this._maxSimultaneousTextures; channel++) {\n        this._activeChannel = channel;\n\n        this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n\n        this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n\n        if (this.webGLVersion > 1) {\n          this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n\n          this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n        }\n      }\n    }\n    /**\n     * Sets a texture to the according uniform.\n     * @param channel The texture channel\n     * @param uniform The uniform to set\n     * @param texture The texture to apply\n     * @param name The name of the uniform in the effect\n     */\n\n  }, {\n    key: \"setTexture\",\n    value: function setTexture(channel, uniform, texture, name) {\n      if (channel === undefined) {\n        return;\n      }\n\n      if (uniform) {\n        this._boundUniforms[channel] = uniform;\n      }\n\n      this._setTexture(channel, texture);\n    }\n  }, {\n    key: \"_bindSamplerUniformToChannel\",\n    value: function _bindSamplerUniformToChannel(sourceSlot, destination) {\n      var uniform = this._boundUniforms[sourceSlot];\n\n      if (!uniform || uniform._currentState === destination) {\n        return;\n      }\n\n      this._gl.uniform1i(uniform, destination);\n\n      uniform._currentState = destination;\n    }\n  }, {\n    key: \"_getTextureWrapMode\",\n    value: function _getTextureWrapMode(mode) {\n      switch (mode) {\n        case 1:\n          return this._gl.REPEAT;\n\n        case 0:\n          return this._gl.CLAMP_TO_EDGE;\n\n        case 2:\n          return this._gl.MIRRORED_REPEAT;\n      }\n\n      return this._gl.REPEAT;\n    }\n  }, {\n    key: \"_setTexture\",\n    value: function _setTexture(channel, texture) {\n      var isPartOfTextureArray = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var depthStencilTexture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var name = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n\n      // Not ready?\n      if (!texture) {\n        if (this._boundTexturesCache[channel] != null) {\n          this._activeChannel = channel;\n\n          this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n\n          this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n\n          if (this.webGLVersion > 1) {\n            this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n\n            this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n          }\n        }\n\n        return false;\n      } // Video\n\n\n      if (texture.video) {\n        this._activeChannel = channel;\n        texture.update();\n      } else if (texture.delayLoadState === 4) {\n        // Delay loading\n        texture.delayLoad();\n        return false;\n      }\n\n      var internalTexture;\n\n      if (depthStencilTexture) {\n        internalTexture = texture.depthStencilTexture;\n      } else if (texture.isReady()) {\n        internalTexture = texture.getInternalTexture();\n      } else if (texture.isCube) {\n        internalTexture = this.emptyCubeTexture;\n      } else if (texture.is3D) {\n        internalTexture = this.emptyTexture3D;\n      } else if (texture.is2DArray) {\n        internalTexture = this.emptyTexture2DArray;\n      } else {\n        internalTexture = this.emptyTexture;\n      }\n\n      if (!isPartOfTextureArray && internalTexture) {\n        internalTexture._associatedChannel = channel;\n      }\n\n      var needToBind = true;\n\n      if (this._boundTexturesCache[channel] === internalTexture) {\n        if (!isPartOfTextureArray) {\n          this._bindSamplerUniformToChannel(internalTexture._associatedChannel, channel);\n        }\n\n        needToBind = false;\n      }\n\n      this._activeChannel = channel;\n\n      var target = this._getTextureTarget(internalTexture);\n\n      if (needToBind) {\n        this._bindTextureDirectly(target, internalTexture, isPartOfTextureArray);\n      }\n\n      if (internalTexture && !internalTexture.isMultiview) {\n        // CUBIC_MODE and SKYBOX_MODE both require CLAMP_TO_EDGE.  All other modes use REPEAT.\n        if (internalTexture.isCube && internalTexture._cachedCoordinatesMode !== texture.coordinatesMode) {\n          internalTexture._cachedCoordinatesMode = texture.coordinatesMode;\n          var textureWrapMode = texture.coordinatesMode !== 3 && texture.coordinatesMode !== 5 ? 1 : 0;\n          texture.wrapU = textureWrapMode;\n          texture.wrapV = textureWrapMode;\n        }\n\n        if (internalTexture._cachedWrapU !== texture.wrapU) {\n          internalTexture._cachedWrapU = texture.wrapU;\n\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(texture.wrapU), internalTexture);\n        }\n\n        if (internalTexture._cachedWrapV !== texture.wrapV) {\n          internalTexture._cachedWrapV = texture.wrapV;\n\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(texture.wrapV), internalTexture);\n        }\n\n        if (internalTexture.is3D && internalTexture._cachedWrapR !== texture.wrapR) {\n          internalTexture._cachedWrapR = texture.wrapR;\n\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(texture.wrapR), internalTexture);\n        }\n\n        this._setAnisotropicLevel(target, internalTexture, texture.anisotropicFilteringLevel);\n      }\n\n      return true;\n    }\n    /**\n     * Sets an array of texture to the webGL context\n     * @param channel defines the channel where the texture array must be set\n     * @param uniform defines the associated uniform location\n     * @param textures defines the array of textures to bind\n     * @param name name of the channel\n     */\n\n  }, {\n    key: \"setTextureArray\",\n    value: function setTextureArray(channel, uniform, textures, name) {\n      if (channel === undefined || !uniform) {\n        return;\n      }\n\n      if (!this._textureUnits || this._textureUnits.length !== textures.length) {\n        this._textureUnits = new Int32Array(textures.length);\n      }\n\n      for (var i = 0; i < textures.length; i++) {\n        var texture = textures[i].getInternalTexture();\n\n        if (texture) {\n          this._textureUnits[i] = channel + i;\n          texture._associatedChannel = channel + i;\n        } else {\n          this._textureUnits[i] = -1;\n        }\n      }\n\n      this._gl.uniform1iv(uniform, this._textureUnits);\n\n      for (var index = 0; index < textures.length; index++) {\n        this._setTexture(this._textureUnits[index], textures[index], true);\n      }\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_setAnisotropicLevel\",\n    value: function _setAnisotropicLevel(target, internalTexture, anisotropicFilteringLevel) {\n      var anisotropicFilterExtension = this._caps.textureAnisotropicFilterExtension;\n\n      if (internalTexture.samplingMode !== 11 && internalTexture.samplingMode !== 3 && internalTexture.samplingMode !== 2) {\n        anisotropicFilteringLevel = 1; // Forcing the anisotropic to 1 because else webgl will force filters to linear\n      }\n\n      if (anisotropicFilterExtension && internalTexture._cachedAnisotropicFilteringLevel !== anisotropicFilteringLevel) {\n        this._setTextureParameterFloat(target, anisotropicFilterExtension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(anisotropicFilteringLevel, this._caps.maxAnisotropy), internalTexture);\n\n        internalTexture._cachedAnisotropicFilteringLevel = anisotropicFilteringLevel;\n      }\n    }\n  }, {\n    key: \"_setTextureParameterFloat\",\n    value: function _setTextureParameterFloat(target, parameter, value, texture) {\n      this._bindTextureDirectly(target, texture, true, true);\n\n      this._gl.texParameterf(target, parameter, value);\n    }\n  }, {\n    key: \"_setTextureParameterInteger\",\n    value: function _setTextureParameterInteger(target, parameter, value, texture) {\n      if (texture) {\n        this._bindTextureDirectly(target, texture, true, true);\n      }\n\n      this._gl.texParameteri(target, parameter, value);\n    }\n    /**\n     * Unbind all vertex attributes from the webGL context\n     */\n\n  }, {\n    key: \"unbindAllAttributes\",\n    value: function unbindAllAttributes() {\n      if (this._mustWipeVertexAttributes) {\n        this._mustWipeVertexAttributes = false;\n\n        for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n          this.disableAttributeByIndex(i);\n        }\n\n        return;\n      }\n\n      for (var _i2 = 0, ul = this._vertexAttribArraysEnabled.length; _i2 < ul; _i2++) {\n        if (_i2 >= this._caps.maxVertexAttribs || !this._vertexAttribArraysEnabled[_i2]) {\n          continue;\n        }\n\n        this.disableAttributeByIndex(_i2);\n      }\n    }\n    /**\n     * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n     */\n\n  }, {\n    key: \"releaseEffects\",\n    value: function releaseEffects() {\n      for (var name in this._compiledEffects) {\n        var webGLPipelineContext = this._compiledEffects[name].getPipelineContext();\n\n        this._deletePipelineContext(webGLPipelineContext);\n      }\n\n      this._compiledEffects = {};\n    }\n    /**\n     * Dispose and release all associated resources\n     */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      var _this$releaseComputeE;\n\n      this.stopRenderLoop(); // Clear observables\n\n      if (this.onBeforeTextureInitObservable) {\n        this.onBeforeTextureInitObservable.clear();\n      } // Empty texture\n\n\n      if (this._emptyTexture) {\n        this._releaseTexture(this._emptyTexture);\n\n        this._emptyTexture = null;\n      }\n\n      if (this._emptyCubeTexture) {\n        this._releaseTexture(this._emptyCubeTexture);\n\n        this._emptyCubeTexture = null;\n      }\n\n      if (this._dummyFramebuffer) {\n        this._gl.deleteFramebuffer(this._dummyFramebuffer);\n      } // Release effects\n\n\n      this.releaseEffects();\n      (_this$releaseComputeE = this.releaseComputeEffects) === null || _this$releaseComputeE === void 0 ? void 0 : _this$releaseComputeE.call(this); // Unbind\n\n      this.unbindAllAttributes();\n      this._boundUniforms = {}; // Events\n\n      if (IsWindowObjectExist()) {\n        if (this._renderingCanvas) {\n          if (!this._doNotHandleContextLost) {\n            this._renderingCanvas.removeEventListener(\"webglcontextlost\", this._onContextLost);\n\n            this._renderingCanvas.removeEventListener(\"webglcontextrestored\", this._onContextRestored);\n          }\n\n          window.removeEventListener(\"resize\", this._checkForMobile);\n        }\n      }\n\n      this._workingCanvas = null;\n      this._workingContext = null;\n      this._currentBufferPointers.length = 0;\n      this._renderingCanvas = null;\n      this._currentProgram = null;\n      this._boundRenderFunction = null;\n      Effect.ResetCache(); // Abort active requests\n\n      var _iterator8 = _createForOfIteratorHelper(this._activeRequests),\n          _step8;\n\n      try {\n        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n          var request = _step8.value;\n          request.abort();\n        }\n      } catch (err) {\n        _iterator8.e(err);\n      } finally {\n        _iterator8.f();\n      }\n\n      this.onDisposeObservable.notifyObservers(this);\n      this.onDisposeObservable.clear();\n    }\n    /**\n     * Attach a new callback raised when context lost event is fired\n     * @param callback defines the callback to call\n     */\n\n  }, {\n    key: \"attachContextLostEvent\",\n    value: function attachContextLostEvent(callback) {\n      if (this._renderingCanvas) {\n        this._renderingCanvas.addEventListener(\"webglcontextlost\", callback, false);\n      }\n    }\n    /**\n     * Attach a new callback raised when context restored event is fired\n     * @param callback defines the callback to call\n     */\n\n  }, {\n    key: \"attachContextRestoredEvent\",\n    value: function attachContextRestoredEvent(callback) {\n      if (this._renderingCanvas) {\n        this._renderingCanvas.addEventListener(\"webglcontextrestored\", callback, false);\n      }\n    }\n    /**\n     * Get the current error code of the webGL context\n     * @returns the error code\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getError\n     */\n\n  }, {\n    key: \"getError\",\n    value: function getError() {\n      return this._gl.getError();\n    }\n  }, {\n    key: \"_canRenderToFloatFramebuffer\",\n    value: function _canRenderToFloatFramebuffer() {\n      if (this._webGLVersion > 1) {\n        return this._caps.colorBufferFloat;\n      }\n\n      return this._canRenderToFramebuffer(1);\n    }\n  }, {\n    key: \"_canRenderToHalfFloatFramebuffer\",\n    value: function _canRenderToHalfFloatFramebuffer() {\n      if (this._webGLVersion > 1) {\n        return this._caps.colorBufferFloat;\n      }\n\n      return this._canRenderToFramebuffer(2);\n    } // Thank you : http://stackoverflow.com/questions/28827511/webgl-ios-render-to-floating-point-texture\n\n  }, {\n    key: \"_canRenderToFramebuffer\",\n    value: function _canRenderToFramebuffer(type) {\n      var gl = this._gl; //clear existing errors\n      // eslint-disable-next-line no-empty\n\n      while (gl.getError() !== gl.NO_ERROR) {}\n\n      var successful = true;\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texImage2D(gl.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(type), 1, 1, 0, gl.RGBA, this._getWebGLTextureType(type), null);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      var fb = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n      var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n      successful = successful && status === gl.FRAMEBUFFER_COMPLETE;\n      successful = successful && gl.getError() === gl.NO_ERROR; //try render by clearing frame buffer's color buffer\n\n      if (successful) {\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        successful = successful && gl.getError() === gl.NO_ERROR;\n      } //try reading from frame to ensure render occurs (just creating the FBO is not sufficient to determine if rendering is supported)\n\n\n      if (successful) {\n        //in practice it's sufficient to just read from the backbuffer rather than handle potentially issues reading from the texture\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        var readFormat = gl.RGBA;\n        var readType = gl.UNSIGNED_BYTE;\n        var buffer = new Uint8Array(4);\n        gl.readPixels(0, 0, 1, 1, readFormat, readType, buffer);\n        successful = successful && gl.getError() === gl.NO_ERROR;\n      } //clean up\n\n\n      gl.deleteTexture(texture);\n      gl.deleteFramebuffer(fb);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null); //clear accumulated errors\n      // eslint-disable-next-line no-empty\n\n      while (!successful && gl.getError() !== gl.NO_ERROR) {}\n\n      return successful;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getWebGLTextureType\",\n    value: function _getWebGLTextureType(type) {\n      if (this._webGLVersion === 1) {\n        switch (type) {\n          case 1:\n            return this._gl.FLOAT;\n\n          case 2:\n            return this._gl.HALF_FLOAT_OES;\n\n          case 0:\n            return this._gl.UNSIGNED_BYTE;\n\n          case 8:\n            return this._gl.UNSIGNED_SHORT_4_4_4_4;\n\n          case 9:\n            return this._gl.UNSIGNED_SHORT_5_5_5_1;\n\n          case 10:\n            return this._gl.UNSIGNED_SHORT_5_6_5;\n        }\n\n        return this._gl.UNSIGNED_BYTE;\n      }\n\n      switch (type) {\n        case 3:\n          return this._gl.BYTE;\n\n        case 0:\n          return this._gl.UNSIGNED_BYTE;\n\n        case 4:\n          return this._gl.SHORT;\n\n        case 5:\n          return this._gl.UNSIGNED_SHORT;\n\n        case 6:\n          return this._gl.INT;\n\n        case 7:\n          // Refers to UNSIGNED_INT\n          return this._gl.UNSIGNED_INT;\n\n        case 1:\n          return this._gl.FLOAT;\n\n        case 2:\n          return this._gl.HALF_FLOAT;\n\n        case 8:\n          return this._gl.UNSIGNED_SHORT_4_4_4_4;\n\n        case 9:\n          return this._gl.UNSIGNED_SHORT_5_5_5_1;\n\n        case 10:\n          return this._gl.UNSIGNED_SHORT_5_6_5;\n\n        case 11:\n          return this._gl.UNSIGNED_INT_2_10_10_10_REV;\n\n        case 12:\n          return this._gl.UNSIGNED_INT_24_8;\n\n        case 13:\n          return this._gl.UNSIGNED_INT_10F_11F_11F_REV;\n\n        case 14:\n          return this._gl.UNSIGNED_INT_5_9_9_9_REV;\n\n        case 15:\n          return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n      }\n\n      return this._gl.UNSIGNED_BYTE;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getInternalFormat\",\n    value: function _getInternalFormat(format) {\n      var useSRGBBuffer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var internalFormat = useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA;\n\n      switch (format) {\n        case 0:\n          internalFormat = this._gl.ALPHA;\n          break;\n\n        case 1:\n          internalFormat = this._gl.LUMINANCE;\n          break;\n\n        case 2:\n          internalFormat = this._gl.LUMINANCE_ALPHA;\n          break;\n\n        case 6:\n          internalFormat = this._gl.RED;\n          break;\n\n        case 7:\n          internalFormat = this._gl.RG;\n          break;\n\n        case 4:\n          internalFormat = useSRGBBuffer ? this._gl.SRGB : this._gl.RGB;\n          break;\n\n        case 5:\n          internalFormat = useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA;\n          break;\n      }\n\n      if (this._webGLVersion > 1) {\n        switch (format) {\n          case 8:\n            internalFormat = this._gl.RED_INTEGER;\n            break;\n\n          case 9:\n            internalFormat = this._gl.RG_INTEGER;\n            break;\n\n          case 10:\n            internalFormat = this._gl.RGB_INTEGER;\n            break;\n\n          case 11:\n            internalFormat = this._gl.RGBA_INTEGER;\n            break;\n        }\n      }\n\n      return internalFormat;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getRGBABufferInternalSizedFormat\",\n    value: function _getRGBABufferInternalSizedFormat(type, format) {\n      var useSRGBBuffer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (this._webGLVersion === 1) {\n        if (format !== undefined) {\n          switch (format) {\n            case 0:\n              return this._gl.ALPHA;\n\n            case 1:\n              return this._gl.LUMINANCE;\n\n            case 2:\n              return this._gl.LUMINANCE_ALPHA;\n\n            case 4:\n              return useSRGBBuffer ? this._gl.SRGB : this._gl.RGB;\n          }\n        }\n\n        return this._gl.RGBA;\n      }\n\n      switch (type) {\n        case 3:\n          switch (format) {\n            case 6:\n              return this._gl.R8_SNORM;\n\n            case 7:\n              return this._gl.RG8_SNORM;\n\n            case 4:\n              return this._gl.RGB8_SNORM;\n\n            case 8:\n              return this._gl.R8I;\n\n            case 9:\n              return this._gl.RG8I;\n\n            case 10:\n              return this._gl.RGB8I;\n\n            case 11:\n              return this._gl.RGBA8I;\n\n            default:\n              return this._gl.RGBA8_SNORM;\n          }\n\n        case 0:\n          switch (format) {\n            case 6:\n              return this._gl.R8;\n\n            case 7:\n              return this._gl.RG8;\n\n            case 4:\n              return useSRGBBuffer ? this._gl.SRGB8 : this._gl.RGB8;\n            // By default. Other possibilities are RGB565, SRGB8.\n\n            case 5:\n              return useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA8;\n            // By default. Other possibilities are RGB5_A1, RGBA4, SRGB8_ALPHA8.\n\n            case 8:\n              return this._gl.R8UI;\n\n            case 9:\n              return this._gl.RG8UI;\n\n            case 10:\n              return this._gl.RGB8UI;\n\n            case 11:\n              return this._gl.RGBA8UI;\n\n            case 0:\n              return this._gl.ALPHA;\n\n            case 1:\n              return this._gl.LUMINANCE;\n\n            case 2:\n              return this._gl.LUMINANCE_ALPHA;\n\n            default:\n              return this._gl.RGBA8;\n          }\n\n        case 4:\n          switch (format) {\n            case 8:\n              return this._gl.R16I;\n\n            case 9:\n              return this._gl.RG16I;\n\n            case 10:\n              return this._gl.RGB16I;\n\n            case 11:\n              return this._gl.RGBA16I;\n\n            default:\n              return this._gl.RGBA16I;\n          }\n\n        case 5:\n          switch (format) {\n            case 8:\n              return this._gl.R16UI;\n\n            case 9:\n              return this._gl.RG16UI;\n\n            case 10:\n              return this._gl.RGB16UI;\n\n            case 11:\n              return this._gl.RGBA16UI;\n\n            default:\n              return this._gl.RGBA16UI;\n          }\n\n        case 6:\n          switch (format) {\n            case 8:\n              return this._gl.R32I;\n\n            case 9:\n              return this._gl.RG32I;\n\n            case 10:\n              return this._gl.RGB32I;\n\n            case 11:\n              return this._gl.RGBA32I;\n\n            default:\n              return this._gl.RGBA32I;\n          }\n\n        case 7:\n          // Refers to UNSIGNED_INT\n          switch (format) {\n            case 8:\n              return this._gl.R32UI;\n\n            case 9:\n              return this._gl.RG32UI;\n\n            case 10:\n              return this._gl.RGB32UI;\n\n            case 11:\n              return this._gl.RGBA32UI;\n\n            default:\n              return this._gl.RGBA32UI;\n          }\n\n        case 1:\n          switch (format) {\n            case 6:\n              return this._gl.R32F;\n            // By default. Other possibility is R16F.\n\n            case 7:\n              return this._gl.RG32F;\n            // By default. Other possibility is RG16F.\n\n            case 4:\n              return this._gl.RGB32F;\n            // By default. Other possibilities are RGB16F, R11F_G11F_B10F, RGB9_E5.\n\n            case 5:\n              return this._gl.RGBA32F;\n            // By default. Other possibility is RGBA16F.\n\n            default:\n              return this._gl.RGBA32F;\n          }\n\n        case 2:\n          switch (format) {\n            case 6:\n              return this._gl.R16F;\n\n            case 7:\n              return this._gl.RG16F;\n\n            case 4:\n              return this._gl.RGB16F;\n            // By default. Other possibilities are R11F_G11F_B10F, RGB9_E5.\n\n            case 5:\n              return this._gl.RGBA16F;\n\n            default:\n              return this._gl.RGBA16F;\n          }\n\n        case 10:\n          return this._gl.RGB565;\n\n        case 13:\n          return this._gl.R11F_G11F_B10F;\n\n        case 14:\n          return this._gl.RGB9_E5;\n\n        case 8:\n          return this._gl.RGBA4;\n\n        case 9:\n          return this._gl.RGB5_A1;\n\n        case 11:\n          switch (format) {\n            case 5:\n              return this._gl.RGB10_A2;\n            // By default. Other possibility is RGB5_A1.\n\n            case 11:\n              return this._gl.RGB10_A2UI;\n\n            default:\n              return this._gl.RGB10_A2;\n          }\n\n      }\n\n      return useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA8;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_getRGBAMultiSampleBufferFormat\",\n    value: function _getRGBAMultiSampleBufferFormat(type) {\n      if (type === 1) {\n        return this._gl.RGBA32F;\n      } else if (type === 2) {\n        return this._gl.RGBA16F;\n      }\n\n      return this._gl.RGBA8;\n    }\n    /**\n     * @internal\n     */\n\n  }, {\n    key: \"_loadFile\",\n    value: function _loadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n      var _this6 = this;\n\n      var request = ThinEngine._FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError);\n\n      this._activeRequests.push(request);\n\n      request.onCompleteObservable.add(function (request) {\n        _this6._activeRequests.splice(_this6._activeRequests.indexOf(request), 1);\n      });\n      return request;\n    }\n    /**\n     * Loads a file from a url\n     * @param url url to load\n     * @param onSuccess callback called when the file successfully loads\n     * @param onProgress callback called while file is loading (if the server supports this mode)\n     * @param offlineProvider defines the offline provider for caching\n     * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n     * @param onError callback called when the file fails to load\n     * @returns a file request object\n     * @internal\n     */\n\n  }, {\n    key: \"readPixels\",\n    value:\n    /**\n     * Reads pixels from the current frame buffer. Please note that this function can be slow\n     * @param x defines the x coordinate of the rectangle where pixels must be read\n     * @param y defines the y coordinate of the rectangle where pixels must be read\n     * @param width defines the width of the rectangle where pixels must be read\n     * @param height defines the height of the rectangle where pixels must be read\n     * @param hasAlpha defines whether the output should have alpha or not (defaults to true)\n     * @param flushRenderer true to flush the renderer from the pending commands before reading the pixels\n     * @returns a ArrayBufferView promise (Uint8Array) containing RGBA colors\n     */\n    function readPixels(x, y, width, height) {\n      var hasAlpha = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      var flushRenderer = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n      var numChannels = hasAlpha ? 4 : 3;\n      var format = hasAlpha ? this._gl.RGBA : this._gl.RGB;\n      var data = new Uint8Array(height * width * numChannels);\n\n      if (flushRenderer) {\n        this.flushFramebuffer();\n      }\n\n      this._gl.readPixels(x, y, width, height, format, this._gl.UNSIGNED_BYTE, data);\n\n      return Promise.resolve(data);\n    }\n    /**\n     * Gets a Promise<boolean> indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     */\n\n  }, {\n    key: \"getHostDocument\",\n    value:\n    /**\n     * Gets host document\n     * @returns the host document object\n     */\n    function getHostDocument() {\n      if (this._renderingCanvas && this._renderingCanvas.ownerDocument) {\n        return this._renderingCanvas.ownerDocument;\n      }\n\n      return IsDocumentAvailable() ? document : null;\n    }\n  }], [{\n    key: \"NpmPackage\",\n    get: function get() {\n      return \"babylonjs@5.25.0\";\n    }\n    /**\n     * Returns the current version of the framework\n     */\n\n  }, {\n    key: \"Version\",\n    get: function get() {\n      return \"5.25.0\";\n    }\n  }, {\n    key: \"ShadersRepository\",\n    get: function get() {\n      return Effect.ShadersRepository;\n    },\n    set: function set(value) {\n      Effect.ShadersRepository = value;\n    }\n  }, {\n    key: \"_CreateCanvas\",\n    value: function _CreateCanvas(width, height) {\n      if (typeof document === \"undefined\") {\n        return new OffscreenCanvas(width, height);\n      }\n\n      var canvas = document.createElement(\"canvas\");\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    }\n  }, {\n    key: \"_ConcatenateShader\",\n    value: function _ConcatenateShader(source, defines) {\n      var shaderVersion = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n      return shaderVersion + (defines ? defines + \"\\n\" : \"\") + source;\n    }\n  }, {\n    key: \"_FileToolsLoadImage\",\n    value: function _FileToolsLoadImage(input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n      throw _WarnImport(\"FileTools\");\n    }\n  }, {\n    key: \"_FileToolsLoadFile\",\n    value: function _FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n      throw _WarnImport(\"FileTools\");\n    }\n  }, {\n    key: \"IsSupportedAsync\",\n    get: function get() {\n      return Promise.resolve(this.isSupported());\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     */\n\n  }, {\n    key: \"IsSupported\",\n    get: function get() {\n      return this.isSupported(); // Backward compat\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     * @returns true if the engine can be created\n     * @ignorenaming\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n\n  }, {\n    key: \"isSupported\",\n    value: function isSupported() {\n      if (this._HasMajorPerformanceCaveat !== null) {\n        return !this._HasMajorPerformanceCaveat; // We know it is performant so WebGL is supported\n      }\n\n      if (this._IsSupported === null) {\n        try {\n          var tempcanvas = this._CreateCanvas(1, 1);\n\n          var gl = tempcanvas.getContext(\"webgl\") || tempcanvas.getContext(\"experimental-webgl\");\n          this._IsSupported = gl != null && !!window.WebGLRenderingContext;\n        } catch (e) {\n          this._IsSupported = false;\n        }\n      }\n\n      return this._IsSupported;\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated on a performant device (ie. if a webGL context can be found and it does not use a slow implementation)\n     */\n\n  }, {\n    key: \"HasMajorPerformanceCaveat\",\n    get: function get() {\n      if (this._HasMajorPerformanceCaveat === null) {\n        try {\n          var tempcanvas = this._CreateCanvas(1, 1);\n\n          var gl = tempcanvas.getContext(\"webgl\", {\n            failIfMajorPerformanceCaveat: true\n          }) || tempcanvas.getContext(\"experimental-webgl\", {\n            failIfMajorPerformanceCaveat: true\n          });\n          this._HasMajorPerformanceCaveat = !gl;\n        } catch (e) {\n          this._HasMajorPerformanceCaveat = false;\n        }\n      }\n\n      return this._HasMajorPerformanceCaveat;\n    }\n    /**\n     * Find the next highest power of two.\n     * @param x Number to start search from.\n     * @returns Next highest power of two.\n     */\n\n  }, {\n    key: \"CeilingPOT\",\n    value: function CeilingPOT(x) {\n      x--;\n      x |= x >> 1;\n      x |= x >> 2;\n      x |= x >> 4;\n      x |= x >> 8;\n      x |= x >> 16;\n      x++;\n      return x;\n    }\n    /**\n     * Find the next lowest power of two.\n     * @param x Number to start search from.\n     * @returns Next lowest power of two.\n     */\n\n  }, {\n    key: \"FloorPOT\",\n    value: function FloorPOT(x) {\n      x = x | x >> 1;\n      x = x | x >> 2;\n      x = x | x >> 4;\n      x = x | x >> 8;\n      x = x | x >> 16;\n      return x - (x >> 1);\n    }\n    /**\n     * Find the nearest power of two.\n     * @param x Number to start search from.\n     * @returns Next nearest power of two.\n     */\n\n  }, {\n    key: \"NearestPOT\",\n    value: function NearestPOT(x) {\n      var c = ThinEngine.CeilingPOT(x);\n      var f = ThinEngine.FloorPOT(x);\n      return c - x > x - f ? f : c;\n    }\n    /**\n     * Get the closest exponent of two\n     * @param value defines the value to approximate\n     * @param max defines the maximum value to return\n     * @param mode defines how to define the closest value\n     * @returns closest exponent of two of the given value\n     */\n\n  }, {\n    key: \"GetExponentOfTwo\",\n    value: function GetExponentOfTwo(value, max) {\n      var mode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 2;\n      var pot;\n\n      switch (mode) {\n        case 1:\n          pot = ThinEngine.FloorPOT(value);\n          break;\n\n        case 2:\n          pot = ThinEngine.NearestPOT(value);\n          break;\n\n        case 3:\n        default:\n          pot = ThinEngine.CeilingPOT(value);\n          break;\n      }\n\n      return Math.min(pot, max);\n    }\n    /**\n     * Queue a new function into the requested animation frame pool (ie. this function will be executed byt the browser for the next frame)\n     * @param func - the function to be called\n     * @param requester - the object that will request the next frame. Falls back to window.\n     * @returns frame number\n     */\n\n  }, {\n    key: \"QueueNewFrame\",\n    value: function QueueNewFrame(func, requester) {\n      if (!IsWindowObjectExist()) {\n        if (typeof requestAnimationFrame !== \"undefined\") {\n          return requestAnimationFrame(func);\n        }\n\n        return setTimeout(func, 16);\n      }\n\n      if (!requester) {\n        requester = window;\n      }\n\n      if (requester.requestPostAnimationFrame) {\n        return requester.requestPostAnimationFrame(func);\n      } else if (requester.requestAnimationFrame) {\n        return requester.requestAnimationFrame(func);\n      } else if (requester.msRequestAnimationFrame) {\n        return requester.msRequestAnimationFrame(func);\n      } else if (requester.webkitRequestAnimationFrame) {\n        return requester.webkitRequestAnimationFrame(func);\n      } else if (requester.mozRequestAnimationFrame) {\n        return requester.mozRequestAnimationFrame(func);\n      } else if (requester.oRequestAnimationFrame) {\n        return requester.oRequestAnimationFrame(func);\n      } else {\n        return window.setTimeout(func, 16);\n      }\n    }\n  }]);\n\n  return ThinEngine;\n}();\n/** Use this array to turn off some WebGL2 features on known buggy browsers version */\n\nThinEngine.ExceptionList = [{\n  key: \"Chrome/63.0\",\n  capture: \"63\\\\.0\\\\.3239\\\\.(\\\\d+)\",\n  captureConstraint: 108,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/58\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/59\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Chrome/72.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/73.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/74.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/71\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/72\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, // desktop osx safari 15.4\n{\n  key: \".*AppleWebKit.*(15.4).*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n}, // mobile browsers using safari 15.4 on ios\n{\n  key: \".*(15.4).*AppleWebKit.*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n}];\n/** @internal */\n\nThinEngine._TextureLoaders = []; // Updatable statics so stick with vars here\n\n/**\n * Gets or sets the epsilon value used by collision engine\n */\n\nThinEngine.CollisionsEpsilon = 0.001; // Statics\n\nThinEngine._IsSupported = null;\nThinEngine._HasMajorPerformanceCaveat = null;"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","length","i","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","arr","len","arr2","BufferPointer","this","ThinEngine","canvasOrContext","antialias","options","adaptToDeviceRatio","_adaptToDeviceRatio","_this","_name","forcePOTTextures","isFullscreen","cullBackFaces","renderEvenInBackground","preventCacheWipeBetweenFrames","validateShaderPrograms","_useReverseDepthBuffer","isNDCHalfZRange","hasOriginBottomLeft","disableUniformBuffers","onDisposeObservable","_frameId","_uniformBuffers","_storageBuffers","_webGLVersion","_windowIsBackground","_highPrecisionShadersAllowed","_badOS","_badDesktopOS","_renderingQueueLaunched","_activeRenderLoops","onContextLostObservable","onContextRestoredObservable","_contextWasLost","_doNotHandleContextLost","disableVertexArrayObjects","_colorWrite","_colorWriteChanged","_depthCullingState","_stencilStateComposer","_stencilState","_alphaState","_alphaMode","_alphaEquation","_internalTexturesCache","_renderTargetWrapperCache","_activeChannel","_currentTextureChannel","_boundTexturesCache","_compiledEffects","_vertexAttribArraysEnabled","_uintIndicesCurrentlySet","_currentBoundBuffer","_currentFramebuffer","_dummyFramebuffer","_currentBufferPointers","_currentInstanceLocations","_currentInstanceBuffers","_vaoRecordInProgress","_mustWipeVertexAttributes","_nextFreeTextureSlots","_maxSimultaneousTextures","_maxMSAASamplesOverride","_activeRequests","_lastDevicePixelRatio","_transformTextureUrl","hostInformation","isMobile","premultipliedAlpha","onBeforeTextureInitObservable","_isWebGPU","_snapshotRenderingMode","_useExactSrgbConversions","_viewportCached","x","y","z","w","_unpackFlipYCached","enableUnpackFlipYCached","_boundUniforms","canvas","_creationOptions","stencilGlobal","useHighPrecisionMatrix","getContext","_renderingCanvas","undefined","deterministicLockstep","lockstepMaxSteps","timeStep","preserveDrawingBuffer","audioEngine","audioEngineOptions","audioContext","_audioContext","audioDestination","_audioDestination","stencil","xrCompatible","useExactSrgbConversions","doNotHandleContextLost","navigator","userAgent","_checkForMobile","currentUA","indexOf","document","window","addEventListener","_step","ua","_iterator","ExceptionList","exception","key","targets","RegExp","capture","captureConstraint","constraint","matches","exec","parseInt","_step2","_iterator2","_onContextLost","evt","preventDefault","notifyObservers","_onContextRestored","_restoreEngineAfterContextLost","_initGLContext","bind","powerPreference","disableWebGL2Support","_gl","_shaderPlatformName","deleteQuery","Error","renderbufferStorageMultisample","attributes","getContextAttributes","pixelStorei","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","useHighPrecisionFloats","devicePixelRatio","limitDeviceRatio","_hardwareScalingLevel","Math","min","resize","_isStencilEnable","_initFeatures","_caps","maxVertexAttribs","_shaderProcessor","webGLVersion","versionToLog","concat","Version","console","log","description","setAttribute","get","parallelShaderCompile","set","shaderLanguage","useReverse","depthFunc","highPrecisionShaderSupported","dimensions","_framebufferDimensionsObject","_cachedViewport","_emptyTexture","createRawTexture","Uint8Array","_emptyTexture3D","createRawTexture3D","_emptyTexture2DArray","createRawTexture2DArray","_emptyCubeTexture","faceData","cubeData","createRawCubeTexture","activate","mode","snapshotRendering","width","height","_CreateCanvas","createElement","initEngine","_this2","setTimeout","_callee","_this2$_rebuildComput","depthTest","depthMask","stencilTest","_context","prev","_rebuildEffects","_rebuildComputeEffects","_rebuildInternalTextures","_rebuildRenderTargetWrappers","_rebuildBuffers","wipeCaches","stop","doNotHandleTouchAction","_step3","_iterator3","_rebuild","_step4","_iterator4","effect","_pipelineContext","_wasPreviouslyReady","_prepareEffect","isReady","_step5","_iterator5","_step6","_iterator6","maxTexturesImageUnits","getParameter","MAX_TEXTURE_IMAGE_UNITS","maxCombinedTexturesImageUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","maxVertexTextureImageUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxSamples","MAX_SAMPLES","maxCubemapTextureSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxRenderTextureSize","MAX_RENDERBUFFER_SIZE","MAX_VERTEX_ATTRIBS","maxVaryingVectors","MAX_VARYING_VECTORS","maxFragmentUniformVectors","MAX_FRAGMENT_UNIFORM_VECTORS","maxVertexUniformVectors","MAX_VERTEX_UNIFORM_VECTORS","getExtension","standardDerivatives","maxAnisotropy","astc","bptc","s3tc","s3tc_srgb","pvrtc","etc1","etc2","textureAnisotropicFilterExtension","uintIndices","fragmentDepthSupported","timerQuery","supportOcclusionQuery","canUseTimestampForTimerQuery","drawBuffersExtension","maxMSAASamples","colorBufferFloat","textureFloat","textureHalfFloat","textureHalfFloatRender","textureFloatLinearFiltering","textureFloatRender","textureHalfFloatLinearFiltering","vertexArrayObject","instancedArrays","textureLOD","blendMinMax","multiview","oculusMultiview","depthTextureExtension","canUseGLInstanceID","canUseGLVertexID","supportComputeShaders","supportSRGBBuffers","supportTransformFeedbacks","textureMaxLevel","texture2DArrayMaxLayerCount","_glVersion","VERSION","_this$_gl$getQuery","rendererInfo","_glRenderer","UNMASKED_RENDERER_WEBGL","_glVendor","UNMASKED_VENDOR_WEBGL","VENDOR","RENDERER","HALF_FLOAT_OES","RGBA16F","RGBA32F","DEPTH24_STENCIL8","getQuery","getQueryEXT","TIMESTAMP_EXT","QUERY_COUNTER_BITS_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","_canRenderToFloatFramebuffer","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","COMPRESSED_SRGB_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_SRGB8_ETC2","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","_canRenderToHalfFloatFramebuffer","drawBuffers","drawBuffersWEBGL","DRAW_FRAMEBUFFER","FRAMEBUFFER","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","vertexArrayObjectExtension","createVertexArray","createVertexArrayOES","bindVertexArray","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","instanceExtension","drawArraysInstanced","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","vertexAttribDivisor","vertexAttribDivisorANGLE","getShaderPrecisionFormat","vertexhighp","VERTEX_SHADER","HIGH_FLOAT","fragmenthighp","FRAGMENT_SHADER","precision","blendMinMaxExtension","MAX","MAX_EXT","MIN","MIN_EXT","sRGBExtension","SRGB","SRGB_EXT","SRGB8","SRGB_ALPHA_EXT","SRGB8_ALPHA8","forceSRGBBufferSupportState","LEQUAL","slot","push","_features","forceBitmapOverHTMLImageElement","supportRenderAndCopyToLodForFloatTextures","supportDepthStencilTexture","supportShadowSamplers","uniformBufferHardCheckMatrix","allowTexturePrefiltering","trackUbosInFrame","checkUbosContentBeforeUpload","supportCSM","basisNeedsPOT","support3DTextures","needTypeSuffixInShaderConstants","supportMSAA","supportSSAO2","supportExtendedTextureFormats","supportSwitchCaseInShader","supportSyncTextureRead","needsInvertingBitmap","useUBOBindingCache","needShaderCodeInlining","needToAlwaysBindUniformBuffers","supportRenderPasses","supportSpriteInstancing","_collectUbosUpdatedInFrame","_workingCanvas","createCanvas","context","_workingContext","hasOwnProperty","getGlInfo","vendor","renderer","version","level","renderFunction","index","splice","shouldRender","beginFrame","endFrame","_frameHandler","_queueNewFrame","_boundRenderFunction","getHostWindow","ownerDocument","defaultView","useScreen","arguments","_currentRenderTarget","framebufferWidth","drawingBufferWidth","framebufferHeight","drawingBufferHeight","bindedRenderFunction","requester","QueueNewFrame","_renderLoop","color","backBuffer","depth","useStencilGlobalOnly","stencilStateComposer","applyStates","clearColor","r","g","b","a","COLOR_BUFFER_BIT","useReverseDepthBuffer","GEQUAL","clearDepth","DEPTH_BUFFER_BIT","clearStencil","STENCIL_BUFFER_BIT","clear","viewport","requiredWidth","requiredHeight","getRenderWidth","getRenderHeight","_viewport","flushFramebuffer","forceSetSize","changeRatio","clientWidth","innerWidth","clientHeight","innerHeight","setSize","texture","faceIndex","forceFullscreenViewport","lodLevel","layer","webglRTWrapper","unBindFramebuffer","_bindUnboundFramebuffer","_MSAAFramebuffer","_framebuffer","_texture$texture$_har","gl","is2DArray","framebufferTextureLayer","COLOR_ATTACHMENT0","_hardwareTexture","underlyingResource","isCube","_texture$texture$_har2","framebufferTexture2D","TEXTURE_CUBE_MAP_POSITIVE_X","depthStencilTexture","_depthStencilTexture","_depthStencilTexture$","attachment","_depthStencilTextureWithStencil","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","_depthStencilTexture$2","_depthStencilTexture$3","TEXTURE_2D","setViewport","pow","culling","_ref2","_this$cullBackFaces","zOffset","force","reverseSide","zOffsetUnits","cull","cullFace","BACK","FRONT","setZOffset","setZOffsetUnits","frontFace","CW","CCW","stencilMaterial","enable","framebuffer","bindFramebuffer","_bindTextureDirectly","generateMipmap","_texture$texture","disableGenerateMipMaps","onBeforeUnbind","isMulti","unBindMultiColorAttachmentFramebuffer","READ_FRAMEBUFFER","blitFramebuffer","NEAREST","generateMipMaps","generateMipmaps","flush","bindArrayBuffer","_cachedVertexBuffers","data","_createVertexBuffer","STATIC_DRAW","usage","vbo","createBuffer","dataBuffer","bufferData","ARRAY_BUFFER","Float32Array","_resetVertexBufferBinding","references","DYNAMIC_DRAW","bindIndexBuffer","_cachedIndexBuffer","indices","updatable","_normalizeIndexData","ELEMENT_ARRAY_BUFFER","_resetIndexBufferBinding","is32Bits","BYTES_PER_ELEMENT","Uint32Array","Uint16Array","buffer","_unbindVertexArrayObject","_bindBuffer","pipelineContext","blockName","program","uniformLocation","getUniformBlockIndex","uniformBlockBinding","target","bindBuffer","bufferSubData","indx","size","type","normalized","stride","offset","pointer","changed","active","UNSIGNED_INT","INT","vertexAttribIPointer","vertexAttribPointer","indexBuffer","vertexBuffers","overrideVertexBuffers","getAttributesNames","unbindAllAttributes","order","getAttributeLocation","ai","vertexBuffer","enableVertexAttribArray","getBuffer","_vertexAttribPointer","getSize","byteStride","byteOffset","getIsInstanced","getInstanceDivisor","vao","_bindVertexBuffersAttributes","_cachedVertexArrayObject","vertexDeclaration","vertexStrideSize","_cachedEffectForVertexBuffers","attributesCount","getAttributesCount","FLOAT","_bindIndexBufferWithCache","boundBuffer","ul","instancesBuffer","offsetLocation","_deleteBuffer","deleteBuffer","offsetLocations","bindInstancesBuffer","attributesInfo","computeStride","attributeSize","_i","_ai","_currentEffect","getAttributeLocationByName","attributeName","attributeType","divisor","attributeLocation","disableInstanceAttribute","shouldClean","disableAttributeByIndex","disableVertexAttribArray","useTriangles","indexStart","indexCount","instancesCount","drawElementsType","verticesStart","verticesCount","drawArraysType","fillMode","_reportDrawCall","drawMode","_drawMode","indexFormat","UNSIGNED_SHORT","mult","drawElements","drawArrays","TRIANGLES","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLE_STRIP","TRIANGLE_FAN","_key","getPipelineContext","_deletePipelineContext","webGLPipelineContext","__SPECTOR_rebuildProgram","deleteProgram","defines","baseName","attributesNamesOrOptions","uniformsNamesOrEngine","samplers","fallbacks","onCompiled","onError","indexParameters","_ref3","vertex","vertexElement","vertexToken","vertexSource","fragment","fragmentElement","fragmentToken","fragmentSource","globalDefines","_getGlobalDefines","fullDefines","compiledEffect","source","shaderVersion","_compileRawShader","_ConcatenateShader","shader","createShader","error","NO_ERROR","tempError","getError","isContextLost","shaderSource","compileShader","getShaderSource","vertexCode","fragmentCode","transformFeedbackVaryings","vertexShader","fragmentShader","_createShaderProgram","_compileShader","code","shaderProcessingContext","engine","isParallelCompiled","shaderProgram","createProgram","attachShader","linkProgram","_finalizePipelineContext","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexCompilationError","_log","fragmentCompilationError","getProgramInfoLog","programLinkError","validateProgram","VALIDATE_STATUS","_error","programValidationError","deleteShader","vertexSourceCode","fragmentSourceCode","createAsRaw","rawVertexSourceCode","rawFragmentSourceCode","rebuildRebind","webGLRenderingState","createRawShaderProgram","createShaderProgram","COMPLETION_STATUS_KHR","action","oldHandler","uniformsNames","results","getUniformLocation","attributesNames","getAttribLocation","bindSamplers","onBind","_onBindObservable","uniform","uniform1i","uniform2i","uniform3i","uniform4i","array","uniform1iv","uniform2iv","uniform3iv","uniform4iv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","matrices","uniformMatrix4fv","matrix","uniformMatrix3fv","uniformMatrix2fv","uniform1f","uniform2f","uniform3f","uniform4f","apply","colorMask","bruteForce","_currentProgram","resetTextureCache","reset","UNPACK_PREMULTIPLY_ALPHA_WEBGL","samplingMode","magFilter","minFilter","LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR","NEAREST_MIPMAP_NEAREST","mag","createTexture","_createTexture","fullOptions","format","useSRGBBuffer","isWebGPU","_useSRGBBuffer","layers","filters","_getSamplingParameters","TEXTURE_2D_ARRAY","sizedFormat","_getRGBABufferInternalSizedFormat","internalFormat","_getInternalFormat","_getWebGLTextureType","texImage3D","texImage2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","baseWidth","baseHeight","samples","noMipmap","url","invertY","scene","_this3","onLoad","prepareTexture","prepareTextureProcessFunction","fallback","forcedExtension","mimeType","loaderOptions","fromData","substr","fromBlob","isBase64","originalUrl","_originalUrl","lastDot","lastIndexOf","extension","substring","toLowerCase","loader","queryStringIndex","split","_step7","_iterator7","_TextureLoaders","availableLoader","canLoad","addPendingData","_getUseSRGBBuffer","_buffer","onLoadObserver","onLoadedObservable","add","onInternalError","message","removePendingData","remove","_createTextureBase","onErrorObservable","callback","loadData","loadMipmap","isCompressed","loadFailed","ArrayBuffer","isView","_loadFile","offlineProvider","request","responseURL","onload","img","decoding","close","_FileToolsLoadImage","imageOrientation","Blob","_this4","_prepareWebGLTexture","potWidth","potHeight","continuationCallback","isPot","RGBA","RGB","texelFormat","UNSIGNED_BYTE","_supportsHardwareTextureRescaling","_prepareWorkingCanvas","drawImage","_rescaleTexture","_releaseTexture","destination","onComplete","UNPACK_FLIP_Y_WEBGL","UNPACK_ALIGNMENT","TEXTURE_CUBE_MAP","is3D","TEXTURE_3D","isMultiview","_getTextureTarget","_setTextureParameterInteger","wrapU","wrapV","wrapR","_getTextureWrapMode","_cachedWrapU","_cachedWrapV","TEXTURE_WRAP_R","_cachedWrapR","internalTexture","generateStencil","bilinearFiltering","comparisonFunction","_comparisonFunction","samplingParameters","TEXTURE_COMPARE_FUNC","TEXTURE_COMPARE_MODE","COMPARE_REF_TO_TEXTURE","lod","compressedTexImage2D","imageData","babylonInternalFormat","useTextureWidthAndHeight","textureType","_unpackFlipY","lodMaxWidth","round","LOG2E","lodMaxHeight","max","xOffset","yOffset","texSubImage2D","bindTarget","_uploadDataToTextureDirectly","processFunction","_this5","getCaps","needPOTTextures","GetExponentOfTwo","_prepareWebGLTextureContinuation","generateStencilBuffer","generateDepthBuffer","_createRenderBuffer","DEPTH_STENCIL","depthFormat","DEPTH_COMPONENT16","DEPTH_COMPONENT32F","STENCIL_INDEX8","STENCIL_ATTACHMENT","msInternalFormat","unbindBuffer","renderBuffer","createRenderbuffer","_updateRenderBuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","framebufferRenderbuffer","_texture$_hardwareTex","_deleteTexture","unbindAllTextures","_lodTextureHigh","dispose","_lodTextureMid","_lodTextureLow","_irradianceTexture","rtWrapper","deleteTexture","useProgram","_setProgram","getSamplers","getUniform","activeTexture","TEXTURE0","forTextureDataUpdate","wasPreviouslyBound","isTextureForRendering","_associatedChannel","currentTextureBound","_activateCurrentTexture","_texture$_hardwareTex2","_texture$_hardwareTex3","bindTexture","_bindSamplerUniformToChannel","channel","_setTexture","sourceSlot","_currentState","REPEAT","MIRRORED_REPEAT","isPartOfTextureArray","video","update","delayLoadState","delayLoad","getInternalTexture","emptyCubeTexture","emptyTexture3D","emptyTexture2DArray","emptyTexture","needToBind","_cachedCoordinatesMode","coordinatesMode","textureWrapMode","_setAnisotropicLevel","anisotropicFilteringLevel","textures","_textureUnits","Int32Array","anisotropicFilterExtension","_cachedAnisotropicFilteringLevel","_setTextureParameterFloat","TEXTURE_MAX_ANISOTROPY_EXT","parameter","texParameterf","_i2","_this$releaseComputeE","stopRenderLoop","deleteFramebuffer","releaseEffects","releaseComputeEffects","removeEventListener","_step8","_iterator8","abort","_canRenderToFramebuffer","successful","fb","createFramebuffer","status","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readFormat","readType","readPixels","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","HALF_FLOAT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","FLOAT_32_UNSIGNED_INT_24_8_REV","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RED","RG","RED_INTEGER","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","R8_SNORM","RG8_SNORM","RGB8_SNORM","R8I","RG8I","RGB8I","RGBA8I","RGBA8_SNORM","R8","RG8","RGB8","RGBA8","R8UI","RG8UI","RGB8UI","RGBA8UI","R16I","RG16I","RGB16I","RGBA16I","R16UI","RG16UI","RGB16UI","RGBA16UI","R32I","RG32I","RGB32I","RGBA32I","R32UI","RG32UI","RGB32UI","RGBA32UI","R32F","RG32F","RGB32F","R16F","RG16F","RGB16F","RGB565","R11F_G11F_B10F","RGB9_E5","RGBA4","RGB5_A1","RGB10_A2","RGB10_A2UI","onSuccess","onProgress","useArrayBuffer","_this6","_FileToolsLoadFile","onCompleteObservable","hasAlpha","flushRenderer","numChannels","Promise","resolve","OffscreenCanvas","input","imageBitmapOptions","isSupported","_HasMajorPerformanceCaveat","_IsSupported","tempcanvas","WebGLRenderingContext","failIfMajorPerformanceCaveat","c","CeilingPOT","FloorPOT","pot","NearestPOT","func","requestPostAnimationFrame","requestAnimationFrame","msRequestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","CollisionsEpsilon"],"sourceRoot":""}